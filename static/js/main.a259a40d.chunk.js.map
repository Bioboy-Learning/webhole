{"version":3,"sources":["infrastructure/appicon/dropdown.png","infrastructure/appicon/dropdown_rev.png","color_picker.js","text_splitter.js","infrastructure/const.js","infrastructure/functions.js","infrastructure/widgets.js","cache.js","flows_api.js","Markdown.js","Common.js","react-lazyload/src/utils/event.js","react-lazyload/src/utils/scrollParent.js","react-lazyload/src/index.jsx","react-lazyload/src/utils/debounce.js","react-lazyload/src/utils/throttle.js","Message.js","Config.js","UserAction.js","Flows.js","Title.js","Sidebar.js","PressureHelper.js","App.js","registerServiceWorker.js","index.js","infrastructure/appicon/hole.png","infrastructure/appicon/imasugu.png","infrastructure/appicon/imasugu_rev.png","infrastructure/appicon/syllabus.png","infrastructure/appicon/score.png","infrastructure/appicon/course_survey.png","infrastructure/appicon/homepage.png"],"names":["module","exports","ColorPicker","this","names","current_h","Math","random","name","toLowerCase","PID_RE","URL_PID_RE","NICKNAME_RE","URL_RE","split_text","txt","rules","forEach","rule","regex","concat","apply","map","part","content","split","seg","test","filter","THUHOLE_API_ROOT","get_json","res","ok","Error","status","statusText","text","then","t","JSON","parse","e","console","error","trace","log","SyntaxError","substr","API_VERSION_PARAM","encodeURIComponent","floor","Date","pad2","x","format_time","time","getMonth","getDate","getHours","getMinutes","getSeconds","chinese_format","buildFormatter","chineseStrings","Time","props","stamp","className","date","formatter","title","toLocaleString","timeZone","hour12","short","TitleLine","appicon_hole","appicon_imasugu","appicon_imasugu_rev","appicon_syllabus","appicon_score","appicon_course_survey","appicon_homepage","RecaptchaV2Popup","context","onChange","bind","state","popup_show","on_popup_bound","on_popup","on_close_bound","on_close","setState","captchaRef","reset","execute","recaptchaToken","localStorage","callback","children","ref","el","sitekey","onClick","Component","LoginPopupSelf","loading_status","recaptcha_verified","username_ref","React","createRef","password_ref","input_token_ref","popup_anchor","document","getElementById","createElement","id","body","appendChild","type","do_popup","recaptcha_version","fetch","current","value","method","headers","stringify","excluded_scopes","json","success","alert","msg","catch","toString","includes","set_token","code","user_token","token","result","length","window","recaptchaOptions","useRecaptchaNet","ReactDOM","createPortal","reCaptchaKey","onVerify","autoFocus","defaultValue","do_sendcode","disabled","do_login","token_callback","placeholder","do_input_token","style","fontSize","href","LoginPopup","Cache","db","added_items_since_maintenance","encrypt","decrypt","open_req","indexedDB","open","onerror","onupgradeneeded","event","target","createObjectStore","keyPath","createIndex","unique","onsuccess","setTimeout","maintenance","pid","data","s","o","i","key","new_key","charCodeAt","String","fromCharCode","c","target_version","parseInt","Promise","resolve","reject","get_req","store","tx","transaction","objectStore","get","exception","data_str","version","last_access","put","delete","warn","req","count_req","count","index","openKeyCursor","cur","primaryKey","continue","deleteDatabase","cache","hole_cache","token_param","handle_response","response","a","notify","parse_replies","replies","color_picker","sort","b","cid","info","_display_color","variant","API","load_replies","cache_version","API_BASE","load_replies_with_cache","cached","set_attention","attention","URLSearchParams","append","report","reason","get_list","page","get_search","keyword","get_single","get_attention","md","MarkdownIt","html","linkify","breaks","inline","highlight","str","lang","hljs","getLanguage","__","utils","escapeHtml","use","MarkdownItKaTeX","throwOnError","errorColor","render","escape_regex","string","replace","build_highlight_re","option","isRegex","RegExp","join","slice","ColoredSpan","colors","normalize_url","url","PureComponent","HighlightedMarkdown","processInstructions","shouldProcessNode","node","processNode","currentLevel","HeadingTag","attribs","rel","parent","splitted","Fragment","idx","p","preventDefault","show_pid","substring","HtmlToReact","ProcessNodeDefinitions","processDefaultNode","parser","Parser","author","match","renderedMarkdown","renderMd","parseWithInstructions","rawMd","TEXTAREA_BACKUP","SafeTextarea","on_change_bound","on_change","on_keydown_bound","on_keydown","clear","area_ref","change_callback","submit_callback","on_submit","ctrlKey","altKey","focus","onKeyDown","pwa_prompt_event","PromotionBar","is_ios","navigator","userAgent","matchMedia","matches","standalone","prompt","addEventListener","ClickHandler","moved","init_y","init_x","on_begin_bound","on_begin","on_move_bound","on_move","on_end_bound","on_end","MOVE_THRESHOLD","last_fire","touches","screenY","screenX","abs","do_callback","onTouchStart","onMouseDown","onTouchMove","onMouseMove","on","eventName","opts","attachEvent","call","off","removeEventListener","detachEvent","HTMLElement","documentElement","excludeStaticParent","position","overflowRegex","parentNode","ownerDocument","getComputedStyle","overflow","overflowX","overflowY","defaultBoundingClientRect","LISTEN_FLAG","listeners","pending","passiveEventSupported","Object","defineProperty","delayType","passiveEvent","capture","passive","checkVisible","component","ReactDom","findDOMNode","scrollParent","parentTop","parentHeight","getBoundingClientRect","top","height","windowInnerHeight","innerHeight","clientHeight","intersectionTop","max","intersectionHeight","min","offsetTop","offsets","Array","isArray","offset","checkOverflowVisible","elementHeight","offsetWidth","offsetHeight","getClientRects","checkNormalVisible","visible","hidden","once","push","unmountIfInvisible","hiddenIfInvisible","lazyLoadHandler","listener","indexOf","splice","finalLazyLoadHandler","LazyLoad","scrollport","scrollContainer","querySelector","needResetFinalLazyLoadHandler","undefined","debounce","func","wait","immediate","timeout","args","timestamp","later","last","arguments","callNow","throttle","fn","threshhold","scope","deferTimer","now","clearTimeout","getAttribute","listenerCount","setAttribute","scroll","resize","removeAttribute","visibility","defaultProps","MessageViewer","load","err","BUILTIN_IMGS","DEFAULT_CONFIG","background_img","background_color","pressure","easter_egg","color_scheme","fold","block_words","load_config","loaded_config","config","assign","keys","save_config","bgimg_style","img","color","background","backgroundImage","encodeURI","backgroundColor","backgroundSize","ConfigBackground","save_changes","img_select","on_select","on_change_img","on_change_color","ConfigColorScheme","ConfigTextArea","sift","description","display","ConfigSwitch","switch","val","checked","ConfigUI","save_changes_bound","chg","confirm","location","reload","reset_settings","array","v","TokenCtx","createContext","set_value","DoUpdate","serviceWorker","getRegistrations","registrations","registration","unregister","InfoSidebar","show_sidebar","process","LoginForm","copy","Consumer","copy_token","PostForm","img_tip","preview","img_ref","on_img_change_bound","on_img_change","global_keypress_handler_bound","global_keypress_handler","tagName","action","on_complete","file","return_url","reader","FileReader","onload","fixOrientation","fixed_dataurl","image","Image","width","compressed","rate","sqrt","canvas","ctx","getContext","drawImage","quality","new_url","quality_l","quality_r","toDataURL","round","src","on_got_img","readAsDataURL","files","proc_img","d","do_post","replyClassName","onSubmit","accept","toggle_preview","CLICKABLE_TAGS","audio","QUOTE_BLACKLIST","fold_tags","LATEST_POST_ID","load_single_meta","title_elem","single","reply","deletion_detect","Reply","replyContent","splitIdx","replyText","do_filter_name","tag","img_clickable","onError","alt","FlowItem","likenum","r","is_quote","copy_link","latest_reply","FlowSidebar","error_msg","filter_name","rev","syncState","sync_state","reply_ref","prev","update_count","set_variant","next_attention","prevState","forceCheck","closest","should_text","set","replies_to_show","reverse","replies_cnt","main_thread_elem","show_reply_bar","set_filter_name","toggle_rev","toggle_attention","float","FlowItemRow","needFold","search_param","mode","reply_status","reply_error","some","word","attention_override","hl_rules","parts","quote_id","FlowItemQuote","FlowChunk","list","ind","Flow","search_text","loaded_pages","chunks","announcement","on_scroll_bound","on_scroll","failed","max_id","img_base_url","img_base_url_bak","versions_remote","web_frontend_version","versions_local","finished","use_search","use_regex","regex_search","post","every","scrollHeight","scrollY","load_page","should_deletion_detect","flag_re","ControlBar","set_mode","on_keypress_bound","on_keypress","do_refresh_bound","do_refresh","do_attention_bound","do_attention","hash","decodeURIComponent","lastIndexOf","flag_res","exec","startsWith","scrollTo","onKeyPress","Title","Sidebar","do_close_bound","do_close","do_back_bound","do_back","contents","stack","cur_title","onTouchEnd","click","PressureHelper","level","fired","esc_interval","clearInterval","Pressure","change","force","do_fire","end","polyfill","only","preventSelect","repeat","THRESHOLD","setInterval","new_level","pad","left","right","bottom","DeprecatedAlert","App","override","update_color_scheme","classList","add","remove","addListener","listen_darkmode","default","light","dark","sidebar_stack","flow_render_key","show_sidebar_bound","set_mode_bound","on_pressure_bound","on_pressure","inthu_flag","atob","ns","pop","Provider","SwitchTransition","CSSTransition","classNames","isLocalhost","Boolean","hostname","registerValidSW","swUrl","register","onupdatefound","installingWorker","installing","onstatechange","controller","ready","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.a259a40d.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAC4jAAAuIwF4pT92AAAG2klEQVR42pVXaUxVRxSee+8DRNlEEA1qBGVLS8XIFllKqiBqUcQispgWLKgFFRsMmxuCiGgA/dM2VdvfJjbpkjRpUrv8aRrTdE2Tpqtt05q0tZVa68aj3zc583J98Cz8+N69983MmbN858wZdeTIEeXG4cOHNfh+4MAB59ChQ8FDQ0Pq+PHjqqKiInTRokV1juO8ppT6FrgGjALf479LGHtm8+bNsZw7MjKijh49GtTd3e0x8szTjQmbm+fBgwedY8eO6W9svCw+Pv5UUFDQZ5Zl/WXb9i3gHjAGeOX9NsZGg4ODv8LcF4qLi/M7Ozu14jDCCaTEpJtjgX3ixAm1ffv2OAh7DhbeAManiTtRUVEXysvLk/v7+1VPT48NuROUuO8PTuBELigoKNgAIT9RGCwzQn+NjIy8sHz58qb8/PziLVu2ZACP5OXlPZaTk/NUbGzsecz5wU+R66mpqTsRTtXb26v8lZiwOWKmUlJS9vht/GNycvKehoaGGI7TrfTQwMCABt8JymhqagrLzs6u9Xg8n3MtuKFlLFy48CTCSl5YbiXuczstT0pK2i0L7/EJq85i4zkcE07QlQ6E8WkJ9H8c6+vr00q1tLSELliwoMctC0qM0BMw1DFK6B8KowVw63pM9GLBHS5ISEho40RuTlLyfTIy+fFHz6Ui2EhlZWVVQdZNyLxLmfSkyLO1B+BSst0C4eYwxmQ1Jy5evLiNQuAyB1prK7GJMxVAsI0NLL4PDg4q8KNcPDGG520Q8yF6qaury6HGwdQ0Li7ueUMcuP0cLeHmjBvJwwX4nhJoIZXnWijjYehgUIfhVUhIyKV9+/bRQx41PDysNm3a9DAG/wHGMOHn+vr6CAixGC8KbG1tDcnMzGyYN29eF9AOZTsnA8Y6OCctLa1l165ds6m4GOBAhgIxP4R8etgLoq5nsdKMnj9//pCxfunSpbtNjAw3VqxYsXO6dQBeHKYCEg6b+4BjazBGQnrDwsLeoOdpfThi8wX/BK6C8ZF0GUNAhtP1RUVFG8RD3ilszjl3kMqtDAMU0GlHZdra2uiFj2TOn2VlZXMVUqOGxYKLw8PDLzDPQR7LnAnUkv+h4CxDSV4LlEDpNQFQgvFSIKe9vV2Hz8ghifmN1OylAgxFdHR0i4L1r+PjFv9EhXuaFjON3CnGhYzX6dOn1ZkzZx4IM4fWm1w3qU7ZpaWljwoZ6YVPFU8ypJ7OUZZXxhzks/09gIXZq1atehwoBdYGAMfWAYVguS0cMB6wyIOampokhsgVTnUN2jA/vZWVlRniAUvKs9Ya58ITzJDpkBAVtYNcIgnFAzqVq6qqojH+u5R5Gq6uuxRIdytgsoChmW4WIB0HxQOWnwJRGP/NrcAVfOgQ8FQTBXwhYPzhTk9GRkYVUnQP0Ay0BEAzzxLMrd+xY0eY+/TjkyGorq5OYDX0hQAkfIfNhBSHbbTYn4QUxK6IRWuqMKnsanB0SqMM57pI+B3TcKe0VboEi+W+NDQHTV1dXSzSKw1IAVIDgGNpSNl41HlNYLOeXuWZg8OoXdJwHGnYzUI0F8Xha3HJlcbGxlB3IaLbSkpKCpgtoijxdwCMSk25ijDUiBzLhHL//v0KLdv7stcNFKJEHRcQ5qwhD8putUlF05qlp6c/O10SonN6kZuyR6AsuN9CemZK/MdwIL2rj2MWDgzkSW6OofH8srm5OQiFhAstFhQQKhoVrB+Kvgycw8FzPgDOYfwlYAShSKAHyH42IKwlqP9vGvLB0G3kim6d2b3OmjXrotEejWgP4wftPQwFlSARp3ocE1IDNKHpZZymtYZ8CPknOB2DMM/DpsDDCWDnEsZFmoZxLKhkMwEhjtQFe4qwpG2zsM5DK1evXp0Fmf+a1gwVt0gaEo/voKASYGijdC6sCzfRyVTQElhvuWvDZP29353CNt017ge5sPoX3h0oG0f/SZln+5pS0xGzAUFannI3komJiR1wl84GOd0caUItyRTlbkw5h9Yx5qwrNERyfnzmzJmv7N27l7zy3RHua8vZMpM07F65wPSHiNkHcNs6nufkBjODCpm23LzTW0w1uHwlGw4xxGx+EeQOlWZnYltulKC76QlcJloZN3dqQZHLuP/14WQsqq2tTdq6dWs0MBsnXCI4tBJrOmbMmPGe1HjfOmTQSViu/Def9Grmvh2hSGVA87cC5Do3+YMHi+T2hDkoOpcLCwuLKds0qZNezQL09w7dyu41Nze3LCIi4lW5DfMyqrtbPl3vXsnxUSj9NrLoSaYawyO8efDl1F8JgncG1gl2Q/zeuHHj3JiYmGZs8rH0B3cFfP8GY52Ys4QymH5s6//vev4fhVL/4/SeszAAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAC4jAAAuIwF4pT92AAAFfklEQVR42qWXWWicVRiG/39mUim4NRq88MZWXIpLe+FS6lYKtZsW0UrRUmyllUIXpQiN3hXBC1sxdyom6q2lVRGhUqvFClURUVFUsu+ZmD2TTDKTycTn/fudcPzNJJMaeDOTnHO+7z3ffoLm5uagFFpaWpJ8LmloaAgaGxuD3t7epePj49unpqbeLhQKn4EvwQVwjv+dYm1fOp2u0t76+vqgqampAhmp+XTMqxwB0XcUr8pmsydQ8jPK0oYe0G3f+8AgGGDPn+x9t7+//8HW1taIODKSiyWQ0MGurq4bEKbbjoEZUATTYApMgglDrnDpp2j7hPzk5ORJyN9qJBLlEoiUDw4ObkNIhydQ6JHQ4eHhF1jfgLlXg7v5vn5oaGj3xMTE++xpjZ0ZyWQy+7Fo4Cw6H4GENnLgcExIu/6HRa7XugjOBcno7Oy8EjI7ccVvOstnJIP4OG4kwlIEopuj6JAdlElnuFUtiq/Tmt1ApkwiTJ+hIWF+TmiP9nZ0dChgj/my+LtGJPyYcAHnzL5VfuRAXgfGxsZe1rrWLCOCcuAHMO7agazs1CUWM7KkyYtiwm0OdUuL7KJTLiFAt/VvWQ4SdiYpZbjkCbOEAjhHYN7hLiWWS8QEU7/jfM73Ov3PlAfOrEZoQbi9Zu6UvnOhaic/n89/3dbWFq1FBQNGd7IwbinWiTWuRkjolLe3t1+BKZ8nJV8FRyH4ylxgrVp7RkdHDxIDyxwJXQQZARb4wSxcxCpbpTtiy6E3HTuYHnI+crGB8v2xrFgQEHrLBa0XYxtdvcjlcp9HMcDtr4LZr8Ysze2v8fI11MGBgYFtZqFiGcq1J0+wvWRyQnNnILOj6yfb8zc/VQGp8RR/9Mr8sDppfgtjUR1QcFZBdjN4FGwsAa1tAverDMcKT5Si6HvNKmmGorZbjGrFRqwx9d65Uk4H5a/FIF71nBv6+voesdKt/nEq4NcX1lByKq9+jvoW4OB9NJjHwCawuQS0tgU8jLkTMRKRO3t6em5ReVZ1Bd+KwFfW1bKq7UYgjPWF7ZYhZQchMVDtVc7AlXB0VJpy9YwzInDeCpAI3OUT8LJg72KzgMx6ww9Cj8C1rLeBFkfgrOeC9XEXWPSmRkZGdpCih8EBcLAEDqiXsHePmlI8DswFy9E1rHoDLioIP+JLvyKT4rCrVBBqKvqfQRjaVLXGglA6zyot9lhEFl0Jjqeh0N3dXcXhleA2cHsJaG0lZr7R0vlfWaCeg4WOWhqOkYYvilEVVvjLikMbplsaL0RE9UPms1FDpgRGLcLTuOHZeCFSbUDXBQvoIQrRTa4U17rgIeCe8eIgCkKEHVlsEHK792KlOOQi95j5p2lI56NSLH+x8IAKkRZg+AeNpILDUUuVEKxSiateh+iHoE6jVwnUsf4BqMGyy72OGHVVKu0ZV8656K6oGWl0lmlYPO2l0DFzQcqZ73LghhNL5Z2uV3DJX+iOumRKG1IWnTcrMGxoEMOn3UjtDSTlwO1VO0+Zhe/V9OxGM9J9nbk5FZ8H99nkop1Z0vJJu00YL88LjGSz8YPyNVZpC2bd407nf4ZS+Qlfn/AHSU0ymCv0htKkd9PAS9toZHMTkWSprugizu8E3seSpfiacyy3m4pEjdfbReY7zLbFxqiSY7lLNW69VgOHnXXKT2tSduRKPkwcCQ0U9uqZTS2E/ah+Tmdcp64GKsEysIIYWqsGhKJvrNDMntObQCNZXPmCTzOErkbg2di0U7CUVeHpstdTxpRO+1OTCDNNbXCZFFc+7+PUjdQyO758HJN+apNTxh6iae9xOmBVUBYbhvQ5sug5pdrlPk79B0aFUsleyVUUG/WOT8D39jS/CH7XJ2tH2LNCe60hJRd6nv8Dwj5T3q96iTAAAAAASUVORK5CYII=\"","// https://martin.ankerl.com/2009/12/09/how-to-create-random-colors-programmatically/\n\nconst golden_ratio_conjugate = 0.618033988749895;\n\nexport class ColorPicker {\n  constructor() {\n    this.names = {};\n    this.current_h = Math.random();\n  }\n\n  get(name) {\n    name = name.toLowerCase();\n    if (name === '洞主') return ['hsl(0,0%,97%)', 'hsl(0,0%,16%)'];\n\n    if (!this.names[name]) {\n      this.current_h += golden_ratio_conjugate;\n      this.current_h %= 1;\n      this.names[name] = [\n        `hsl(${this.current_h * 360}, 50%, 90%)`,\n        `hsl(${this.current_h * 360}, 60%, 20%)`,\n      ];\n    }\n    return this.names[name];\n  }\n}\n","// regexp should match the WHOLE segmented part\n// export const PID_RE=/(^|[^\\d\\u20e3\\ufe0e\\ufe0f])([2-9]\\d{4,5}|1\\d{4,6})(?![\\d\\u20e3\\ufe0e\\ufe0f])/g;\nexport const PID_RE = /(^|[^\\d\\u20e3\\ufe0e\\ufe0f])(#\\d{1,7})(?![\\d\\u20e3\\ufe0e\\ufe0f])/g;\n// TODO: fix this re\n// export const URL_PID_RE=/((?:https?:\\/\\/)?thuhole\\.com\\/?#(?:#|%23)([2-9]\\d{4,5}|1\\d{4,6}))(?!\\d|\\u20e3|\\ufe0e|\\ufe0f)/g;\nexport const URL_PID_RE = /((?:https?:\\/\\/)?thuhole\\.com\\/?#(?:#|%23)(\\d{1,7}))(?!\\d|\\u20e3|\\ufe0e|\\ufe0f)/g;\nexport const NICKNAME_RE = /(^|[^A-Za-z])((?:(?:Angry|Baby|Crazy|Diligent|Excited|Fat|Greedy|Hungry|Interesting|Jolly|Kind|Little|Magic|Naïve|Old|PKU|Quiet|Rich|Superman|Tough|Undefined|Valuable|Wifeless|Xiangbuchulai|Young|Zombie)\\s)?(?:Alice|Bob|Carol|Dave|Eve|Francis|Grace|Hans|Isabella|Jason|Kate|Louis|Margaret|Nathan|Olivia|Paul|Queen|Richard|Susan|Thomas|Uma|Vivian|Winnie|Xander|Yasmine|Zach)|You Win(?: \\d+)?|洞主)(?![A-Za-z])/gi;\nexport const URL_RE = /(^|[^.@a-zA-Z0-9_])((?:https?:\\/\\/)?(?:(?:[\\w-]+\\.)+[a-zA-Z]{2,3}|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})(?::\\d{1,5})?(?:\\/[\\w~!@#$%^&*()\\-_=+[\\]{};:,./?|]*)?)(?![a-zA-Z0-9])/gi;\n\nexport function split_text(txt, rules) {\n  // rules: [['name',/regex/],...]\n  // return: [['name','part'],[null,'part'],...]\n\n  txt = [[null, txt]];\n  rules.forEach((rule) => {\n    let [name, regex] = rule;\n    txt = [].concat.apply(\n      [],\n      txt.map((part) => {\n        let [rule, content] = part;\n        if (rule)\n          // already tagged by previous rules\n          return [part];\n        else {\n          return content\n            .split(regex)\n            .map((seg) => (regex.test(seg) ? [name, seg] : [null, seg]))\n            .filter(([name, seg]) => name !== null || seg);\n        }\n      }),\n    );\n  });\n  return txt;\n}\n","// export const THUHOLE_API_ROOT='//localhost:5001/';\nexport const THUHOLE_API_ROOT = 'https://api.thuhole.com/'\n","export function get_json(res) {\n    if(!res.ok) throw Error(`网络错误 ${res.status} ${res.statusText}`);\n    return (\n        res\n            .text()\n            .then((t)=>{\n                try {\n                    return JSON.parse(t);\n                } catch(e) {\n                    console.error('json parse error');\n                    console.trace(e);\n                    console.log(t);\n                    throw new SyntaxError('JSON Parse Error '+t.substr(0,50));\n                }\n            })\n    );\n}\n\nexport function listen_darkmode(override) { // override: true/false/undefined\n    function update_color_scheme() {\n        if(override===undefined ? window.matchMedia('(prefers-color-scheme: dark)').matches : override)\n            document.body.classList.add('root-dark-mode');\n        else\n            document.body.classList.remove('root-dark-mode');\n    }\n\n    update_color_scheme();\n    window.matchMedia('(prefers-color-scheme: dark)').addListener(()=>{\n        update_color_scheme();\n    });\n}\n\nexport function API_VERSION_PARAM() {\n    return '&PKUHelperAPI=3.0&jsapiver='+encodeURIComponent((process.env.REACT_APP_BUILD_INFO||'null')+'-'+(Math.floor(+new Date()/7200000)*2));\n}","import React, { Component, PureComponent } from 'react';\nimport ReactDOM from 'react-dom';\n\nimport TimeAgo from 'react-timeago';\nimport chineseStrings from 'react-timeago/lib/language-strings/zh-CN';\nimport buildFormatter from 'react-timeago/lib/formatters/buildFormatter';\n\nimport './global.css';\nimport './widgets.css';\n\nimport appicon_hole from './appicon/hole.png';\nimport appicon_imasugu from './appicon/imasugu.png';\nimport appicon_imasugu_rev from './appicon/imasugu_rev.png';\nimport appicon_syllabus from './appicon/syllabus.png';\nimport appicon_score from './appicon/score.png';\nimport appicon_course_survey from './appicon/course_survey.png';\nimport appicon_dropdown from './appicon/dropdown.png';\nimport appicon_dropdown_rev from './appicon/dropdown_rev.png';\nimport appicon_homepage from './appicon/homepage.png';\nimport { THUHOLE_API_ROOT } from './const';\nimport { get_json, API_VERSION_PARAM } from './functions';\n\nimport {\n  GoogleReCaptchaProvider,\n  GoogleReCaptcha,\n} from 'react-google-recaptcha-v3';\nimport ReCAPTCHA from 'react-google-recaptcha';\n\nconst LOGIN_POPUP_ANCHOR_ID = 'pkuhelper_login_popup_anchor';\n\nfunction pad2(x) {\n  return x < 10 ? '0' + x : '' + x;\n}\nexport function format_time(time) {\n  return `${time.getMonth() + 1}-${pad2(\n    time.getDate(),\n  )} ${time.getHours()}:${pad2(time.getMinutes())}:${pad2(time.getSeconds())}`;\n}\nconst chinese_format = buildFormatter(chineseStrings);\nexport function Time(props) {\n  const time = new Date(props.stamp * 1000);\n  return (\n    <span className={'time-str'}>\n      <TimeAgo\n        date={time}\n        formatter={chinese_format}\n        title={time.toLocaleString('zh-CN', {\n          timeZone: 'Asia/Shanghai',\n          hour12: false,\n        })}\n      />\n      &nbsp;\n      {!props.short ? format_time(time) : null}\n    </span>\n  );\n}\n\nexport function TitleLine(props) {\n  return (\n    <p className=\"centered-line title-line aux-margin\">\n      <span className=\"black-outline\">{props.text}</span>\n    </p>\n  );\n}\n\nexport function GlobalTitle(props) {\n  return (\n    <div className=\"aux-margin\">\n      <div className=\"title\">\n        <p className=\"centered-line\">{props.text}</p>\n      </div>\n    </div>\n  );\n}\n\nconst FALLBACK_APPS = {\n  // id, text, url, icon_normal, icon_hover, new_tab\n  bar: [\n    ['hole', '树洞', '/hole', appicon_hole, null, false],\n    [\n      'imasugu',\n      '教室',\n      '/spare_classroom',\n      appicon_imasugu,\n      appicon_imasugu_rev,\n      false,\n    ],\n    ['syllabus', '课表', '/syllabus', appicon_syllabus, null, false],\n    ['score', '成绩', '/my_score', appicon_score, null, false],\n  ],\n  dropdown: [\n    [\n      'course_survey',\n      '课程测评',\n      'https://courses.pinzhixiaoyuan.com/',\n      appicon_course_survey,\n      null,\n      true,\n    ],\n    ['homepage', '客户端', '/', appicon_homepage, null, true],\n  ],\n  fix: {},\n};\n// const SWITCHER_DATA_VER='switcher_2';\n// const SWITCHER_DATA_URL=THUHOLE_API_ROOT+'web_static/appswitcher_items.json';\n\n// export class AppSwitcher extends Component {\n//     constructor(props) {\n//         super(props);\n//         this.state={\n//             apps: this.get_apps_from_localstorage(),\n//         }\n//     }\n//\n//     get_apps_from_localstorage() {\n//         let ret=FALLBACK_APPS;\n//         if(localStorage['APPSWITCHER_ITEMS'])\n//             try {\n//                 let content=JSON.parse(localStorage['APPSWITCHER_ITEMS'])[SWITCHER_DATA_VER];\n//                 if(!content || !content.bar)\n//                     throw new Error('content is empty');\n//\n//                 ret=content;\n//             } catch(e) {\n//                 console.error('load appswitcher items from localstorage failed');\n//                 console.trace(e);\n//             }\n//\n//         return ret;\n//     }\n//\n//     check_fix() {\n//         if(this.state.apps && this.state.apps.fix && this.state.apps.fix[this.props.appid])\n//             setTimeout(()=>{\n//                 window.HOTFIX_CONTEXT={\n//                     build_info: process.env.REACT_APP_BUILD_INFO || '---',\n//                     build_env: process.env.NODE_ENV,\n//                 };\n//                 eval(this.state.apps.fix[this.props.appid]);\n//             },1); // make it async so failures won't be critical\n//     }\n//\n//     componentDidMount() {\n//         this.check_fix();\n//         setTimeout(()=>{\n//             fetch(SWITCHER_DATA_URL)\n//                 .then((res)=>{\n//                     if(!res.ok) throw Error(`网络错误 ${res.status} ${res.statusText}`);\n//                     return res.text();\n//                 })\n//                 .then((txt)=>{\n//                     if(txt!==localStorage['APPSWITCHER_ITEMS']) {\n//                         console.log('loaded new appswitcher items',txt);\n//                         localStorage['APPSWITCHER_ITEMS']=txt;\n//\n//                         this.setState({\n//                             apps: this.get_apps_from_localstorage(),\n//                         });\n//                     } else {\n//                         console.log('appswitcher items unchanged');\n//                     }\n//                 })\n//                 .catch((e)=>{\n//                     console.error('loading appswitcher items failed');\n//                     console.trace(e);\n//                 });\n//         },500);\n//     }\n//\n//     componentDidUpdate(prevProps, prevState) {\n//         if(this.state.apps!==prevState.apps)\n//             this.check_fix();\n//     }\n//\n//     render() {\n//         let cur_id=this.props.appid;\n//\n//         function app_elem([id,title,url,icon_normal,icon_hover,new_tab],no_class=false,ref=null) {\n//             return (\n//                 <a ref={ref} key={id} className={no_class ? null : ('app-switcher-item'+(id===cur_id ? ' app-switcher-item-current' : ''))}\n//                    href={url} target={new_tab ? '_blank' : '_self'}>\n//                     {!!icon_normal && [\n//                         <img key=\"normal\" src={icon_normal} className=\"app-switcher-logo-normal\" />,\n//                         <img key=\"hover\" src={icon_hover||icon_normal} className=\"app-switcher-logo-hover\" />\n//                     ]}\n//                     <span>{title}</span>\n//                 </a>\n//             );\n//         }\n//\n//         let dropdown_cur_app=null;\n//         this.state.apps.dropdown.forEach((app)=>{\n//             if(app[0]===cur_id)\n//                 dropdown_cur_app=app;\n//         });\n//\n//         //console.log(JSON.stringify(this.state.apps));\n//\n//         return (\n//             <div className=\"app-switcher\">\n//                 <span className=\"app-switcher-desc app-switcher-left\">PKUHelper</span>\n//                 {this.state.apps.bar.map((app)=>\n//                     app_elem(app)\n//                 )}\n//                 {!!this.state.apps.dropdown.length &&\n//                     <div className={\n//                         'app-switcher-item app-switcher-dropdown '\n//                         +(dropdown_cur_app ? ' app-switcher-item-current' : '')\n//                     }>\n//                         <p className=\"app-switcher-dropdown-title\">\n//                             {!!dropdown_cur_app ?\n//                                 app_elem((()=>{\n//                                     let [id,title,_url,icon_normal,icon_hover,_new_tab]=dropdown_cur_app;\n//                                     return [id,title+'▾',null,icon_normal,icon_hover,false];\n//                                 })(),true) :\n//                                 app_elem(['-placeholder-elem','更多▾',null,appicon_dropdown,appicon_dropdown_rev,false],true)\n//                             }\n//                         </p>\n//                         {this.state.apps.dropdown.map((app)=>{\n//                             let ref=React.createRef();\n//                             return (\n//                                 <p key={app[0]} className=\"app-switcher-dropdown-item\" onClick={(e)=>{\n//                                     if(!e.target.closest('a') && ref.current)\n//                                         ref.current.click();\n//                                 }}>\n//                                     {app_elem(app,true,ref)}\n//                                 </p>\n//                             );\n//                         })}\n//                     </div>\n//                 }\n//                 <span className=\"app-switcher-desc app-switcher-right\">网页版</span>\n//             </div>\n//         );\n//     }\n// }\n\nclass RecaptchaV2Popup extends Component {\n  constructor(props, context) {\n    super(props, context);\n    this.onChange = this.onChange.bind(this);\n    this.state = {\n      popup_show: false,\n    };\n    this.on_popup_bound = this.on_popup.bind(this);\n    this.on_close_bound = this.on_close.bind(this);\n  }\n\n  on_popup() {\n    this.setState({\n      popup_show: true,\n    });\n  }\n  on_close() {\n    this.setState({\n      popup_show: false,\n    });\n  }\n\n  componentDidMount() {\n    if (this.captchaRef) {\n      console.log('started, just a second...');\n      this.captchaRef.reset();\n      this.captchaRef.execute();\n    }\n  }\n  onChange(recaptchaToken) {\n    localStorage['recaptcha'] = recaptchaToken;\n    this.setState({\n      popup_show: false,\n    });\n    this.props.callback();\n  }\n\n  render() {\n    return (\n      <>\n        {this.props.children(this.on_popup_bound)}\n        {this.state.popup_show && (\n          <div>\n            <div className=\"thuhole-login-popup-shadow\" />\n            <div className=\"thuhole-login-popup\">\n              <div className=\"g-recaptcha\">\n                <ReCAPTCHA\n                  ref={(el) => {\n                    this.captchaRef = el;\n                  }}\n                  sitekey=\"6LdPSa4ZAAAAAIeoB22GChKqrF1H0R_BaEGGz7Hf\"\n                  // size={\"compact\"}\n                  onChange={this.onChange}\n                />\n              </div>\n\n              <p>\n                <button onClick={this.on_close_bound}>取消</button>\n              </p>\n            </div>\n          </div>\n        )}\n      </>\n    );\n  }\n}\n\nclass LoginPopupSelf extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading_status: 'idle',\n      recaptcha_verified: false,\n      // excluded_scopes: [],\n    };\n    this.username_ref = React.createRef();\n    this.password_ref = React.createRef();\n    this.input_token_ref = React.createRef();\n\n    this.popup_anchor = document.getElementById(LOGIN_POPUP_ANCHOR_ID);\n    if (!this.popup_anchor) {\n      this.popup_anchor = document.createElement('div');\n      this.popup_anchor.id = LOGIN_POPUP_ANCHOR_ID;\n      document.body.appendChild(this.popup_anchor);\n    }\n  }\n\n  do_sendcode(type, do_popup, recaptcha_version) {\n    if (!this.state.recaptcha_verified) {\n      alert('reCAPTCHA风控系统正在评估您的浏览器安全状态，请稍后重试。');\n      return;\n    }\n    if (this.state.loading_status === 'loading') return;\n\n    this.setState(\n      {\n        loading_status: 'loading',\n      },\n      () => {\n        fetch(\n          THUHOLE_API_ROOT +\n            'api_xmcp/login/send_code' +\n            '?user=' +\n            encodeURIComponent(this.username_ref.current.value) +\n            '&code_type=' +\n            encodeURIComponent(type) +\n            '&recaptcha_version=' +\n            encodeURIComponent(recaptcha_version) +\n            '&recaptcha_token=' +\n            localStorage['recaptcha'] +\n            API_VERSION_PARAM(),\n          {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json',\n            },\n            body: JSON.stringify({\n              excluded_scopes: [],\n            }),\n          },\n        )\n          .then(get_json)\n          .then((json) => {\n            console.log(json);\n            if (!json.success) throw new Error(JSON.stringify(json));\n\n            alert(json.msg);\n            this.setState({\n              loading_status: 'done',\n            });\n          })\n          .catch((e) => {\n            console.error(e);\n\n            if (e.toString().includes('风控系统校验失败')) {\n              // alert('TODO: use recaptcha v2');\n              this.setState({\n                loading_status: 'done',\n              });\n              do_popup();\n            } else {\n              alert('发送失败\\n' + e);\n              this.setState({\n                loading_status: 'done',\n              });\n            }\n          });\n      },\n    );\n  }\n\n  do_login(set_token) {\n    if (this.state.loading_status === 'loading') return;\n\n    this.setState(\n      {\n        loading_status: 'loading',\n      },\n      () => {\n        fetch(\n          THUHOLE_API_ROOT +\n            'api_xmcp/login/login' +\n            '?user=' +\n            encodeURIComponent(this.username_ref.current.value) +\n            '&valid_code=' +\n            encodeURIComponent(this.password_ref.current.value) +\n            API_VERSION_PARAM(),\n          {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json',\n            },\n            body: JSON.stringify({\n              excluded_scopes: [],\n            }),\n          },\n        )\n          .then(get_json)\n          .then((json) => {\n            if (json.code !== 0) {\n              if (json.msg) throw new Error(json.msg);\n              throw new Error(JSON.stringify(json));\n            }\n\n            set_token(json.user_token);\n            alert(`登录成功`);\n            this.setState({\n              loading_status: 'done',\n            });\n            this.props.on_close();\n          })\n          .catch((e) => {\n            console.error(e);\n            alert('登录失败\\n' + e);\n            this.setState({\n              loading_status: 'done',\n            });\n          });\n      },\n    );\n  }\n\n  do_input_token(set_token) {\n    if (this.state.loading_status === 'loading') return;\n\n    let token = this.input_token_ref.current.value;\n    this.setState(\n      {\n        loading_status: 'loading',\n      },\n      () => {\n        fetch(\n          THUHOLE_API_ROOT +\n            'api_xmcp/hole/system_msg?user_token=' +\n            encodeURIComponent(token) +\n            API_VERSION_PARAM(),\n        )\n          .then((res) => res.json())\n          .then((json) => {\n            if (json.error) throw new Error(json.error);\n            if (json.result.length === 0)\n              throw new Error('result check failed');\n            this.setState({\n              loading_status: 'done',\n            });\n            set_token(token);\n            this.props.on_close();\n          })\n          .catch((e) => {\n            alert('Token检验失败\\n' + e);\n            this.setState({\n              loading_status: 'done',\n            });\n            console.error(e);\n          });\n      },\n    );\n  }\n\n  // perm_alert() {\n  //     alert('如果你不需要 PKU Helper 的某项功能，可以取消相应权限。\\n其中【状态信息】包括你的网费、校园卡余额等。\\n该设置应用到你的【所有】设备，取消后如需再次启用相应功能需要重新登录。');\n  // }\n\n  render() {\n    // let PERM_SCOPES=[\n    //     ['score','成绩查询'],\n    //     ['syllabus','课表查询'],\n    //     ['my_info','状态信息'],\n    // ];\n    window.recaptchaOptions = {\n      useRecaptchaNet: true,\n    };\n    return ReactDOM.createPortal(\n      <GoogleReCaptchaProvider\n        reCaptchaKey={'6Leq0a0ZAAAAAHEStocsqtJfKEs9APB0LdgzTNfZ'}\n        useRecaptchaNet={true}\n      >\n        <GoogleReCaptcha\n          onVerify={(token) => {\n            this.setState({\n              recaptcha_verified: true,\n            });\n            localStorage['recaptcha'] = token;\n          }}\n        />\n        <div>\n          <div className=\"thuhole-login-popup-shadow\" />\n          <div className=\"thuhole-login-popup\">\n            <p>\n              <b>接收验证码来登录 T大树洞</b>\n            </p>\n            <p>\n              <label>\n                　邮箱&nbsp;\n                <input\n                  ref={this.username_ref}\n                  type=\"email\"\n                  autoFocus={true}\n                  defaultValue=\"@mails.tsinghua.edu.cn\"\n                />\n              </label>\n              <span className=\"thuhole-login-type\">\n                {/*<a onClick={(e)=>this.do_sendcode('sms')}>*/}\n                {/*    &nbsp;短信&nbsp;*/}\n                {/*</a>*/}\n                {/*/*/}\n                <RecaptchaV2Popup\n                  callback={() => {\n                    this.do_sendcode(\n                      'mail',\n                      () => {\n                        alert('风控系统校验失败');\n                      },\n                      'v2',\n                    );\n                  }}\n                >\n                  {(do_popup) => (\n                    <a\n                      onClick={(e) => this.do_sendcode('mail', do_popup, 'v3')}\n                    >\n                      &nbsp;发送邮件&nbsp;\n                    </a>\n                  )}\n                </RecaptchaV2Popup>\n              </span>\n            </p>\n            <p>\n              <label>\n                验证码&nbsp;\n                <input ref={this.password_ref} type=\"tel\" />\n              </label>\n              <button\n                type=\"button\"\n                disabled={this.state.loading_status === 'loading'}\n                onClick={(e) => this.do_login(this.props.token_callback)}\n              >\n                登录\n              </button>\n            </p>\n            <hr />\n            <p>\n              <b>从其他设备导入登录状态</b>\n            </p>\n            <p>\n              <input ref={this.input_token_ref} placeholder=\"User Token\" />\n              <button\n                type=\"button\"\n                disabled={this.state.loading_status === 'loading'}\n                onClick={(e) => this.do_input_token(this.props.token_callback)}\n              >\n                导入\n              </button>\n            </p>\n            <hr />\n            <p style={{ fontSize: 11 }}>\n              This site is protected by reCAPTCHA and the Google{' '}\n              <a href=\"https://policies.google.com/privacy\">Privacy Policy</a>{' '}\n              and{' '}\n              <a href=\"https://policies.google.com/terms\">Terms of Service</a>{' '}\n              apply.\n            </p>\n            <p>\n              <button onClick={this.props.on_close}>取消</button>\n            </p>\n          </div>\n        </div>\n      </GoogleReCaptchaProvider>,\n      this.popup_anchor,\n    );\n  }\n}\n\nexport class LoginPopup extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      popup_show: false,\n    };\n    this.on_popup_bound = this.on_popup.bind(this);\n    this.on_close_bound = this.on_close.bind(this);\n  }\n\n  on_popup() {\n    this.setState({\n      popup_show: true,\n    });\n  }\n  on_close() {\n    this.setState({\n      popup_show: false,\n    });\n  }\n\n  render() {\n    return (\n      <>\n        {this.props.children(this.on_popup_bound)}\n        {this.state.popup_show && (\n          <LoginPopupSelf\n            token_callback={this.props.token_callback}\n            on_close={this.on_close_bound}\n          />\n        )}\n      </>\n    );\n  }\n}\n","const HOLE_CACHE_DB_NAME = 'hole_cache_db';\nconst CACHE_DB_VER = 1;\nconst MAINTENANCE_STEP = 150;\nconst MAINTENANCE_COUNT = 1000;\n\nconst ENC_KEY = 42;\n\nclass Cache {\n  constructor() {\n    this.db = null;\n    this.added_items_since_maintenance = 0;\n    this.encrypt = this.encrypt.bind(this);\n    this.decrypt = this.decrypt.bind(this);\n    const open_req = indexedDB.open(HOLE_CACHE_DB_NAME, CACHE_DB_VER);\n    open_req.onerror = console.error.bind(console);\n    open_req.onupgradeneeded = (event) => {\n      console.log('comment cache db upgrade');\n      const db = event.target.result;\n      const store = db.createObjectStore('comment', {\n        keyPath: 'pid',\n      });\n      store.createIndex('last_access', 'last_access', { unique: false });\n    };\n    open_req.onsuccess = (event) => {\n      console.log('comment cache db loaded');\n      this.db = event.target.result;\n      setTimeout(this.maintenance.bind(this), 1);\n    };\n  }\n\n  // use window.hole_cache.encrypt() only after cache is loaded!\n  encrypt(pid, data) {\n    let s = JSON.stringify(data);\n    let o = '';\n    for (let i = 0, key = (ENC_KEY ^ pid) % 128; i < s.length; i++) {\n      let c = s.charCodeAt(i);\n      let new_key = (key ^ (c / 2)) % 128;\n      o += String.fromCharCode(key ^ s.charCodeAt(i));\n      key = new_key;\n    }\n    return o;\n  }\n\n  // use window.hole_cache.decrypt() only after cache is loaded!\n  decrypt(pid, s) {\n    let o = '';\n    if (typeof s !== typeof 'str') return null;\n\n    for (let i = 0, key = (ENC_KEY ^ pid) % 128; i < s.length; i++) {\n      let c = key ^ s.charCodeAt(i);\n      o += String.fromCharCode(c);\n      key = (key ^ (c / 2)) % 128;\n    }\n\n    try {\n      return JSON.parse(o);\n    } catch (e) {\n      console.error('decrypt failed');\n      console.trace(e);\n      return null;\n    }\n  }\n\n  get(pid, target_version) {\n    pid = parseInt(pid);\n    return new Promise((resolve, reject) => {\n      if (!this.db) return resolve(null);\n      let get_req, store;\n      try {\n        const tx = this.db.transaction(['comment'], 'readwrite');\n        store = tx.objectStore('comment');\n        get_req = store.get(pid);\n      } catch (e) {\n        // ios sometimes fail at here, just ignore it\n        console.exception(e);\n        resolve(null);\n      }\n      get_req.onsuccess = () => {\n        let res = get_req.result;\n        if (!res || !res.data_str) {\n          //console.log('comment cache miss '+pid);\n          resolve(null);\n        } else if (target_version === res.version) {\n          // hit\n          console.log('comment cache hit', pid);\n          res.last_access = +new Date();\n          store.put(res);\n          let data = this.decrypt(pid, res.data_str);\n          resolve(data); // obj or null\n        } else {\n          // expired\n          console.log(\n            'comment cache expired',\n            pid,\n            ': ver',\n            res.version,\n            'target',\n            target_version,\n          );\n          store.delete(pid);\n          resolve(null);\n        }\n      };\n      get_req.onerror = (e) => {\n        console.warn('comment cache indexeddb open failed');\n        console.error(e);\n        resolve(null);\n      };\n    });\n  }\n\n  put(pid, target_version, data) {\n    pid = parseInt(pid);\n    return new Promise((resolve, reject) => {\n      if (!this.db) return resolve();\n      try {\n        const tx = this.db.transaction(['comment'], 'readwrite');\n        const store = tx.objectStore('comment');\n        store.put({\n          pid: pid,\n          version: target_version,\n          data_str: this.encrypt(pid, data),\n          last_access: +new Date(),\n        });\n        if (++this.added_items_since_maintenance === MAINTENANCE_STEP)\n          setTimeout(this.maintenance.bind(this), 1);\n      } catch (e) {\n        console.exception(e);\n        return resolve();\n      }\n    });\n  }\n\n  delete(pid) {\n    pid = parseInt(pid);\n    return new Promise((resolve, reject) => {\n      if (!this.db) return resolve();\n      let req;\n      try {\n        const tx = this.db.transaction(['comment'], 'readwrite');\n        const store = tx.objectStore('comment');\n        req = store.delete(pid);\n      } catch (e) {\n        console.exception(e);\n        return resolve();\n      }\n      console.log('comment cache delete', pid);\n      req.onerror = () => {\n        console.warn('comment cache delete failed ', pid);\n        return resolve();\n      };\n      req.onsuccess = () => resolve();\n    });\n  }\n\n  maintenance() {\n    if (!this.db) return;\n    const tx = this.db.transaction(['comment'], 'readwrite');\n    const store = tx.objectStore('comment');\n    let count_req = store.count();\n    count_req.onsuccess = () => {\n      let count = count_req.result;\n      if (count > MAINTENANCE_COUNT) {\n        console.log('comment cache db maintenance', count);\n        store.index('last_access').openKeyCursor().onsuccess = (e) => {\n          let cur = e.target.result;\n          if (cur) {\n            //console.log('maintenance: delete',cur);\n            store.delete(cur.primaryKey);\n            if (--count > MAINTENANCE_COUNT) cur.continue();\n          }\n        };\n      } else {\n        console.log('comment cache db no need to maintenance', count);\n      }\n      this.added_items_since_maintenance = 0;\n    };\n    count_req.onerror = console.error.bind(console);\n  }\n\n  clear() {\n    if (!this.db) return;\n    try {\n      indexedDB.deleteDatabase(HOLE_CACHE_DB_NAME);\n      console.log('delete comment cache db');\n    } catch (e) {\n      console.exception(e);\n    }\n  }\n}\n\nexport function cache() {\n  if (!window.hole_cache) window.hole_cache = new Cache();\n  return window.hole_cache;\n}\n","import { get_json, API_VERSION_PARAM } from './infrastructure/functions';\nimport { THUHOLE_API_ROOT } from './infrastructure/const';\nimport { API_BASE } from './Common';\nimport { cache } from './cache';\n\nexport { THUHOLE_API_ROOT, API_VERSION_PARAM };\n\nexport function token_param(token) {\n  return API_VERSION_PARAM() + (token ? '&user_token=' + token : '');\n}\n\nexport { get_json };\n\nconst SEARCH_PAGESIZE = 50;\n\nconst handle_response = async (response, notify = false) => {\n  let json = await get_json(response);\n  if (json.code !== 0) {\n    if (json.msg) {\n      if (notify) alert(json.msg);\n      else throw new Error(json.msg);\n    } else throw new Error(JSON.stringify(json));\n  }\n  return json;\n};\n\nconst parse_replies = (replies, color_picker) =>\n  replies\n    .sort((a, b) => parseInt(a.cid, 10) - parseInt(b.cid, 10))\n    .map((info) => {\n      info._display_color = color_picker.get(info.name);\n      info.variant = {};\n      return info;\n    });\n\nexport const API = {\n  load_replies: async (pid, token, color_picker, cache_version) => {\n    pid = parseInt(pid);\n    let response = await fetch(\n      API_BASE + '/api.php?action=getcomment&pid=' + pid + token_param(token),\n    );\n    let json = await handle_response(response);\n    // Why delete then put ??\n    cache().put(pid, cache_version, json);\n    json.data = parse_replies(json.data, color_picker);\n    return json;\n  },\n\n  load_replies_with_cache: async (pid, token, color_picker, cache_version) => {\n    pid = parseInt(pid);\n    let json = await cache().get(pid, cache_version);\n    if (json) {\n      json.data = parse_replies(json.data, color_picker);\n      return { data: json, cached: true };\n    } else {\n      json = await API.load_replies(pid, token, color_picker, cache_version);\n      return { data: json, cached: !json };\n    }\n  },\n\n  set_attention: async (pid, attention, token) => {\n    let data = new URLSearchParams();\n    data.append('user_token', token);\n    data.append('pid', pid);\n    data.append('switch', attention ? '1' : '0');\n    let response = await fetch(\n      API_BASE + '/api.php?action=attention' + token_param(token),\n      {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/x-www-form-urlencoded',\n        },\n        body: data,\n      },\n    );\n    // Delete cache to update `attention` on next reload\n    cache().delete(pid);\n    return handle_response(response, true);\n  },\n\n  report: async (pid, reason, token) => {\n    let data = new URLSearchParams();\n    data.append('user_token', token);\n    data.append('pid', pid);\n    data.append('reason', reason);\n    let response = await fetch(\n      API_BASE + '/api.php?action=report' + token_param(token),\n      {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/x-www-form-urlencoded',\n        },\n        body: data,\n      },\n    );\n    return handle_response(response, true);\n  },\n\n  get_list: async (page, token) => {\n    let response = await fetch(\n      API_BASE + '/api.php?action=getlist' + '&p=' + page + token_param(token),\n    );\n    return handle_response(response);\n  },\n\n  get_search: async (page, keyword, token) => {\n    let response = await fetch(\n      API_BASE +\n        '/api.php?action=search' +\n        '&pagesize=' +\n        SEARCH_PAGESIZE +\n        '&page=' +\n        page +\n        '&keywords=' +\n        encodeURIComponent(keyword) +\n        token_param(token),\n    );\n    return handle_response(response);\n  },\n\n  get_single: async (pid, token) => {\n    let response = await fetch(\n      API_BASE + '/api.php?action=getone' + '&pid=' + pid + token_param(token),\n    );\n    return handle_response(response);\n  },\n\n  get_attention: async (token) => {\n    let response = await fetch(\n      API_BASE + '/api.php?action=getattention' + token_param(token),\n    );\n    return handle_response(response);\n  },\n};\n","import MarkdownIt from 'markdown-it';\nimport MarkdownItKaTeX from 'markdown-it-katex';\nimport hljs from 'highlight.js';\nimport 'highlight.js/styles/atom-one-dark.css';\nimport './Markdown.css';\n\nimport 'katex/dist/katex.min.css';\n\nlet md = new MarkdownIt({\n  html: false,\n  linkify: false,\n  breaks: true,\n  inline: true,\n  highlight(str, lang) {\n    if (lang && hljs.getLanguage(lang)) {\n      try {\n        return (\n          '<pre class=\"hljs\"><code>' +\n          hljs.highlight(lang, str, true).value +\n          '</code></pre>'\n        );\n      } catch (__) {}\n    }\n    return (\n      '<pre class=\"hljs\"><code>' + md.utils.escapeHtml(str) + '</code></pre>'\n    );\n  },\n}).use(MarkdownItKaTeX, {\n  throwOnError: false,\n  errorColor: '#aa0000',\n});\n\nexport default (text) => md.render(text);\n","import React, { Component, PureComponent } from 'react';\nimport { format_time, Time, TitleLine } from './infrastructure/widgets';\nimport { THUHOLE_API_ROOT } from './flows_api';\n\nimport HtmlToReact from 'html-to-react';\n\nimport './Common.css';\nimport {\n  URL_PID_RE,\n  URL_RE,\n  PID_RE,\n  NICKNAME_RE,\n  split_text,\n} from './text_splitter';\n\nimport renderMd from './Markdown';\n\nexport { format_time, Time, TitleLine };\n\nexport const API_BASE = THUHOLE_API_ROOT + 'services/thuhole';\n\n// https://stackoverflow.com/questions/3446170/escape-string-for-use-in-javascript-regex\nfunction escape_regex(string) {\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n}\n\nexport function build_highlight_re(\n  txt,\n  split = ' ',\n  option = 'g',\n  isRegex = false,\n) {\n  if (isRegex) {\n    try {\n      return new RegExp('(' + txt.slice(1, -1) + ')', option);\n    } catch (e) {\n      return /^$/g;\n    }\n  } else {\n    return txt\n      ? new RegExp(\n          `(${txt\n            .split(split)\n            .filter((x) => !!x)\n            .map(escape_regex)\n            .join('|')})`,\n          option,\n        )\n      : /^$/g;\n  }\n}\n\nexport function ColoredSpan(props) {\n  return (\n    <span\n      className=\"colored-span\"\n      style={{\n        '--coloredspan-bgcolor-light': props.colors[0],\n        '--coloredspan-bgcolor-dark': props.colors[1],\n      }}\n    >\n      {props.children}\n    </span>\n  );\n}\n\nfunction normalize_url(url) {\n  return /^https?:\\/\\//.test(url) ? url : 'http://' + url;\n}\n\nexport class HighlightedText extends PureComponent {\n  render() {\n    return (\n      <pre>\n        {this.props.parts.map((part, idx) => {\n          let [rule, p] = part;\n          return (\n            <span key={idx}>\n              {rule === 'url_pid' ? (\n                <span className=\"url-pid-link\" title={p}>\n                  /##\n                </span>\n              ) : rule === 'url' ? (\n                <a href={normalize_url(p)} target=\"_blank\" rel=\"noopener\">\n                  {p}\n                </a>\n              ) : rule === 'pid' ? (\n                <a\n                  href={'#' + p}\n                  onClick={(e) => {\n                    e.preventDefault();\n                    this.props.show_pid(p.substring(1));\n                  }}\n                >\n                  {p}\n                </a>\n              ) : rule === 'nickname' ? (\n                <ColoredSpan colors={this.props.color_picker.get(p)}>\n                  {p}\n                </ColoredSpan>\n              ) : rule === 'search' ? (\n                <span className=\"search-query-highlight\">{p}</span>\n              ) : (\n                p\n              )}\n            </span>\n          );\n        })}\n      </pre>\n    );\n  }\n}\n\n// props: text, show_pid, color_picker\nexport class HighlightedMarkdown extends Component {\n  render() {\n    const props = this.props;\n    const processDefs = new HtmlToReact.ProcessNodeDefinitions(React);\n    const processInstructions = [\n      {\n        shouldProcessNode: (node) => node.name === 'img', // disable images\n        processNode(node, children, index) {\n          return <div key={index}>[图片]</div>;\n        },\n      },\n      {\n        shouldProcessNode: (node) => /^h[123456]$/.test(node.name),\n        processNode(node, children, index) {\n          let currentLevel = +node.name[1];\n          if (currentLevel < 3) currentLevel = 3;\n          const HeadingTag = `h${currentLevel}`;\n          return <HeadingTag key={index}>{children}</HeadingTag>;\n        },\n      },\n      {\n        shouldProcessNode: (node) => node.name === 'a',\n        processNode(node, children, index) {\n          return (\n            <a\n              href={normalize_url(node.attribs.href)}\n              target=\"_blank\"\n              rel=\"noopenner noreferrer\"\n              className=\"ext-link\"\n              key={index}\n            >\n              {children}\n              <span className=\"icon icon-new-tab\" />\n            </a>\n          );\n        },\n      },\n      {\n        shouldProcessNode(node) {\n          return (\n            node.type === 'text' &&\n            (!node.parent ||\n              !node.parent.attribs ||\n              node.parent.attribs['encoding'] !== 'application/x-tex')\n          ); // pid, nickname, search\n        },\n        processNode(node, children, index) {\n          const originalText = node.data;\n          const splitted = split_text(originalText, [\n            ['url_pid', URL_PID_RE],\n            ['url', URL_RE],\n            ['pid', PID_RE],\n            ['nickname', NICKNAME_RE],\n          ]);\n\n          return (\n            <React.Fragment key={index}>\n              {splitted.map(([rule, p], idx) => {\n                return (\n                  <span key={idx}>\n                    {rule === 'url_pid' ? (\n                      <span className=\"url-pid-link\" title={p}>\n                        /##\n                      </span>\n                    ) : rule === 'url' ? (\n                      <a\n                        href={normalize_url(p)}\n                        className=\"ext-link\"\n                        target=\"_blank\"\n                        rel=\"noopener noreferrer\"\n                      >\n                        {p}\n                        <span className=\"icon icon-new-tab\" />\n                      </a>\n                    ) : rule === 'pid' ? (\n                      <a\n                        href={'#' + p}\n                        onClick={(e) => {\n                          e.preventDefault();\n                          props.show_pid(p.substring(1));\n                        }}\n                      >\n                        {p}\n                      </a>\n                    ) : rule === 'nickname' ? (\n                      <ColoredSpan colors={props.color_picker.get(p)}>\n                        {p}\n                      </ColoredSpan>\n                    ) : rule === 'search' ? (\n                      <span className=\"search-query-highlight\">{p}</span>\n                    ) : (\n                      p\n                    )}\n                  </span>\n                );\n              })}\n            </React.Fragment>\n          );\n        },\n      },\n      {\n        shouldProcessNode: () => true,\n        processNode: processDefs.processDefaultNode,\n      },\n    ];\n    const parser = new HtmlToReact.Parser();\n    if (\n      props.author &&\n      props.text.match(/^(?:#+ |\\$\\$|>|```|\\t|\\s*-|\\s*\\d+\\.)/)\n    ) {\n      const renderedMarkdown = renderMd(props.text);\n      return (\n        <>\n          {props.author}\n          {parser.parseWithInstructions(\n            renderedMarkdown,\n            (node) => node.type !== 'script',\n            processInstructions,\n          ) || ''}\n        </>\n      );\n    } else {\n      let rawMd = props.text;\n      if (props.author) rawMd = props.author + ' ' + rawMd;\n      const renderedMarkdown = renderMd(rawMd);\n      return (\n        parser.parseWithInstructions(\n          renderedMarkdown,\n          (node) => node.type !== 'script',\n          processInstructions,\n        ) || null\n      );\n    }\n  }\n}\n\nwindow.TEXTAREA_BACKUP = {};\n\nexport class SafeTextarea extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      text: '',\n    };\n    this.on_change_bound = this.on_change.bind(this);\n    this.on_keydown_bound = this.on_keydown.bind(this);\n    this.clear = this.clear.bind(this);\n    this.area_ref = React.createRef();\n    this.change_callback = props.on_change || (() => {});\n    this.submit_callback = props.on_submit || (() => {});\n  }\n\n  componentDidMount() {\n    this.setState(\n      {\n        text: window.TEXTAREA_BACKUP[this.props.id] || '',\n      },\n      () => {\n        this.change_callback(this.state.text);\n      },\n    );\n  }\n\n  componentWillUnmount() {\n    window.TEXTAREA_BACKUP[this.props.id] = this.state.text;\n    this.change_callback(this.state.text);\n  }\n\n  on_change(event) {\n    this.setState({\n      text: event.target.value,\n    });\n    this.change_callback(event.target.value);\n  }\n  on_keydown(event) {\n    if (event.key === 'Enter' && event.ctrlKey && !event.altKey) {\n      event.preventDefault();\n      this.submit_callback();\n    }\n  }\n\n  clear() {\n    this.setState({\n      text: '',\n    });\n  }\n  set(text) {\n    this.change_callback(text);\n    this.setState({\n      text: text,\n    });\n  }\n  get() {\n    return this.state.text;\n  }\n  focus() {\n    this.area_ref.current.focus();\n  }\n\n  render() {\n    return (\n      <textarea\n        ref={this.area_ref}\n        onChange={this.on_change_bound}\n        value={this.state.text}\n        onKeyDown={this.on_keydown_bound}\n      />\n    );\n  }\n}\n\nlet pwa_prompt_event = null;\nwindow.addEventListener('beforeinstallprompt', (e) => {\n  console.log('pwa: received before install prompt');\n  pwa_prompt_event = e;\n});\n\nexport function PromotionBar(props) {\n  let is_ios = /iPhone|iPad|iPod/i.test(window.navigator.userAgent);\n  let is_installed =\n    window.matchMedia('(display-mode: standalone)').matches ||\n    window.navigator.standalone;\n\n  if (is_installed) return null;\n\n  if (is_ios)\n    // noinspection JSConstructorReturnsPrimitive\n    return !navigator.standalone ? (\n      <div className=\"box promotion-bar\">\n        <span className=\"icon icon-about\" />\n        &nbsp; 用 Safari 把树洞 <b>添加到主屏幕</b> 更好用\n      </div>\n    ) : null;\n  // noinspection JSConstructorReturnsPrimitive\n  else\n    return pwa_prompt_event ? (\n      <div className=\"box promotion-bar\">\n        <span className=\"icon icon-about\" />\n        &nbsp; 把网页版树洞{' '}\n        <b>\n          <a\n            onClick={() => {\n              if (pwa_prompt_event) pwa_prompt_event.prompt();\n            }}\n          >\n            安装到桌面\n          </a>\n        </b>{' '}\n        更好用\n      </div>\n    ) : null;\n}\n\nexport class ClickHandler extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      moved: true,\n      init_y: 0,\n      init_x: 0,\n    };\n    this.on_begin_bound = this.on_begin.bind(this);\n    this.on_move_bound = this.on_move.bind(this);\n    this.on_end_bound = this.on_end.bind(this);\n\n    this.MOVE_THRESHOLD = 3;\n    this.last_fire = 0;\n  }\n\n  on_begin(e) {\n    //console.log('click',(e.touches?e.touches[0]:e).screenY,(e.touches?e.touches[0]:e).screenX);\n    this.setState({\n      moved: false,\n      init_y: (e.touches ? e.touches[0] : e).screenY,\n      init_x: (e.touches ? e.touches[0] : e).screenX,\n    });\n  }\n  on_move(e) {\n    if (!this.state.moved) {\n      let mvmt =\n        Math.abs((e.touches ? e.touches[0] : e).screenY - this.state.init_y) +\n        Math.abs((e.touches ? e.touches[0] : e).screenX - this.state.init_x);\n      //console.log('move',mvmt);\n      if (mvmt > this.MOVE_THRESHOLD)\n        this.setState({\n          moved: true,\n        });\n    }\n  }\n  on_end(event) {\n    //console.log('end');\n    if (!this.state.moved) this.do_callback(event);\n    this.setState({\n      moved: true,\n    });\n  }\n\n  do_callback(event) {\n    if (this.last_fire + 100 > +new Date()) return;\n    this.last_fire = +new Date();\n    this.props.callback(event);\n  }\n\n  render() {\n    return (\n      <div\n        onTouchStart={this.on_begin_bound}\n        onMouseDown={this.on_begin_bound}\n        onTouchMove={this.on_move_bound}\n        onMouseMove={this.on_move_bound}\n        onClick={this.on_end_bound}\n      >\n        {this.props.children}\n      </div>\n    );\n  }\n}\n","export function on(el, eventName, callback, opts) {\n  opts = opts || false;\n  if (el.addEventListener) {\n    el.addEventListener(eventName, callback, opts);\n  } else if (el.attachEvent) {\n    el.attachEvent(`on${eventName}`, (e) => {\n      callback.call(el, e || window.event);\n    });\n  }\n}\n\nexport function off(el, eventName, callback, opts) {\n  opts = opts || false;\n  if (el.removeEventListener) {\n    el.removeEventListener(eventName, callback, opts);\n  } else if (el.detachEvent) {\n    el.detachEvent(`on${eventName}`, callback);\n  }\n}\n","/**\n * @fileOverview Find scroll parent\n */\n\nexport default (node) => {\n  if (!(node instanceof HTMLElement)) {\n    return document.documentElement;\n  }\n\n  const excludeStaticParent = node.style.position === 'absolute';\n  const overflowRegex = /(scroll|auto)/;\n  let parent = node;\n\n  while (parent) {\n    if (!parent.parentNode) {\n      return node.ownerDocument || document.documentElement;\n    }\n\n    const style = window.getComputedStyle(parent);\n    const position = style.position;\n    const overflow = style.overflow;\n    const overflowX = style['overflow-x'];\n    const overflowY = style['overflow-y'];\n\n    if (position === 'static' && excludeStaticParent) {\n      parent = parent.parentNode;\n      continue;\n    }\n\n    if (overflowRegex.test(overflow) && overflowRegex.test(overflowX) && overflowRegex.test(overflowY)) {\n      return parent;\n    }\n\n    parent = parent.parentNode;\n  }\n\n  return node.ownerDocument || node.documentElement || document.documentElement;\n};\n","/**\n * react-lazyload\n */\nimport React, { Component, PureComponent } from 'react';\nimport ReactDom from 'react-dom';\nimport PropTypes from 'prop-types';\nimport { on, off } from './utils/event';\nimport scrollParent from './utils/scrollParent';\nimport debounce from './utils/debounce';\nimport throttle from './utils/throttle';\n\nconst defaultBoundingClientRect = { top: 0, right: 0, bottom: 0, left: 0, width: 0, height: 0 };\nconst LISTEN_FLAG = 'data-lazyload-listened';\nconst listeners = [];\nlet pending = [];\n\n// try to handle passive events\nlet passiveEventSupported = false;\ntry {\n  const opts = Object.defineProperty({}, 'passive', {\n    get() {\n      passiveEventSupported = true;\n    }\n  });\n  window.addEventListener('test', null, opts);\n}\ncatch (e) { }\n// if they are supported, setup the optional params\n// IMPORTANT: FALSE doubles as the default CAPTURE value!\nconst passiveEvent = passiveEventSupported ? { capture: false, passive: true } : false;\n\n\n/**\n * Check if `component` is visible in overflow container `parent`\n * @param  {node} component React component\n * @param  {node} parent    component's scroll parent\n * @return {bool}\n */\nconst checkOverflowVisible = function checkOverflowVisible(component, parent) {\n  const node = ReactDom.findDOMNode(component);\n\n  let parentTop;\n  let parentHeight;\n\n  try {\n    ({ top: parentTop, height: parentHeight } = parent.getBoundingClientRect());\n  } catch (e) {\n    ({ top: parentTop, height: parentHeight } = defaultBoundingClientRect);\n  }\n\n  const windowInnerHeight = window.innerHeight || document.documentElement.clientHeight;\n\n  // calculate top and height of the intersection of the element's scrollParent and viewport\n  const intersectionTop = Math.max(parentTop, 0); // intersection's top relative to viewport\n  const intersectionHeight = Math.min(windowInnerHeight, parentTop + parentHeight) - intersectionTop; // height\n\n  // check whether the element is visible in the intersection\n  let top;\n  let height;\n\n  try {\n    ({ top, height } = node.getBoundingClientRect());\n  } catch (e) {\n    ({ top, height } = defaultBoundingClientRect);\n  }\n\n  const offsetTop = top - intersectionTop; // element's top relative to intersection\n\n  const offsets = Array.isArray(component.props.offset) ?\n                component.props.offset :\n                [component.props.offset, component.props.offset]; // Be compatible with previous API\n\n  return (offsetTop - offsets[0] <= intersectionHeight) &&\n         (offsetTop + height + offsets[1] >= 0);\n};\n\n/**\n * Check if `component` is visible in document\n * @param  {node} component React component\n * @return {bool}\n */\nconst checkNormalVisible = function checkNormalVisible(component) {\n  const node = ReactDom.findDOMNode(component);\n\n  // If this element is hidden by css rules somehow, it's definitely invisible\n  if (!(node.offsetWidth || node.offsetHeight || node.getClientRects().length)) return false;\n\n  let top;\n  let elementHeight;\n\n  try {\n    ({ top, height: elementHeight } = node.getBoundingClientRect());\n  } catch (e) {\n    ({ top, height: elementHeight } = defaultBoundingClientRect);\n  }\n\n  const windowInnerHeight = window.innerHeight || document.documentElement.clientHeight;\n\n  const offsets = Array.isArray(component.props.offset) ?\n                component.props.offset :\n                [component.props.offset, component.props.offset]; // Be compatible with previous API\n\n  return (top - offsets[0] <= windowInnerHeight) &&\n         (top + elementHeight + offsets[1] >= 0);\n};\n\n\n/**\n * Detect if element is visible in viewport, if so, set `visible` state to true.\n * If `once` prop is provided true, remove component as listener after checkVisible\n *\n * @param  {React} component   React component that respond to scroll and resize\n */\nconst checkVisible = function checkVisible(component) {\n  const node = ReactDom.findDOMNode(component);\n  if (!(node instanceof HTMLElement)) {\n    return;\n  }\n\n  const parent = scrollParent(node);\n  const isOverflow = component.props.overflow &&\n                     parent !== node.ownerDocument &&\n                     parent !== document &&\n                     parent !== document.documentElement;\n  const visible = isOverflow ?\n                  checkOverflowVisible(component, parent) :\n                  checkNormalVisible(component);\n  if (visible) {\n    // Avoid extra render if previously is visible\n    if (!component.state.visible || component.state.hidden) {\n      if (component.props.once) {\n        pending.push(component);\n      }\n\n      //console.log('lazyload 1');\n      component.setState({\n        visible: true,\n        hidden: false,\n      });\n    }\n  } else if (!component.props.once) {\n    if (component.props.unmountIfInvisible) {\n      if(component.visible===true)\n        component.setState({\n          visible: false,\n        });\n    } else if(component.props.hiddenIfInvisible) {\n      if(component.state.hidden===false) {\n        //console.log('lazyload 3');\n        component.setState({\n          hidden: true,\n        });\n      }\n    }\n  }\n};\n\n\nconst purgePending = function purgePending() {\n  pending.forEach((component) => {\n    const index = listeners.indexOf(component);\n    if (index !== -1) {\n      listeners.splice(index, 1);\n    }\n  });\n\n  pending = [];\n};\n\nconst lazyLoadHandler = () => {\n  for (let i = 0; i < listeners.length; ++i) {\n    const listener = listeners[i];\n    checkVisible(listener);\n  }\n  // Remove `once` component in listeners\n  purgePending();\n};\n\n// Depending on component's props\nlet delayType;\nlet finalLazyLoadHandler = null;\n\nconst isString = string => typeof string === 'string';\n\nclass LazyLoad extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.state={\n      visible: false,\n      hidden: false,\n    };\n  }\n\n  componentDidMount() {\n    // It's unlikely to change delay type on the fly, this is mainly\n    // designed for tests\n    let scrollport = window;\n    const {\n      scrollContainer,\n    } = this.props;\n    if (scrollContainer) {\n      if (isString(scrollContainer)) {\n        scrollport = scrollport.document.querySelector(scrollContainer);\n      }\n    }\n    const needResetFinalLazyLoadHandler = (this.props.debounce !== undefined && delayType === 'throttle')\n      || (delayType === 'debounce' && this.props.debounce === undefined);\n\n    if (needResetFinalLazyLoadHandler) {\n      off(scrollport, 'scroll', finalLazyLoadHandler, passiveEvent);\n      off(window, 'resize', finalLazyLoadHandler, passiveEvent);\n      finalLazyLoadHandler = null;\n    }\n\n    if (!finalLazyLoadHandler) {\n      if (this.props.debounce !== undefined) {\n        finalLazyLoadHandler = debounce(lazyLoadHandler, typeof this.props.debounce === 'number' ?\n                                                         this.props.debounce :\n                                                         300);\n        delayType = 'debounce';\n      } else if (this.props.throttle !== undefined) {\n        finalLazyLoadHandler = throttle(lazyLoadHandler, typeof this.props.throttle === 'number' ?\n                                                         this.props.throttle :\n                                                         300);\n        delayType = 'throttle';\n      } else {\n        finalLazyLoadHandler = lazyLoadHandler;\n      }\n    }\n\n    if (this.props.overflow) {\n      const parent = scrollParent(ReactDom.findDOMNode(this));\n      if (parent && typeof parent.getAttribute === 'function') {\n        const listenerCount = 1 + (+parent.getAttribute(LISTEN_FLAG));\n        if (listenerCount === 1) {\n          parent.addEventListener('scroll', finalLazyLoadHandler, passiveEvent);\n        }\n        parent.setAttribute(LISTEN_FLAG, listenerCount);\n      }\n    } else if (listeners.length === 0 || needResetFinalLazyLoadHandler) {\n      const { scroll, resize } = this.props;\n\n      if (scroll) {\n        on(scrollport, 'scroll', finalLazyLoadHandler, passiveEvent);\n      }\n\n      if (resize) {\n        on(window, 'resize', finalLazyLoadHandler, passiveEvent);\n      }\n    }\n\n    listeners.push(this);\n    checkVisible(this);\n  }\n\n  componentWillUnmount() {\n    if (this.props.overflow) {\n      const parent = scrollParent(ReactDom.findDOMNode(this));\n      if (parent && typeof parent.getAttribute === 'function') {\n        const listenerCount = (+parent.getAttribute(LISTEN_FLAG)) - 1;\n        if (listenerCount === 0) {\n          parent.removeEventListener('scroll', finalLazyLoadHandler, passiveEvent);\n          parent.removeAttribute(LISTEN_FLAG);\n        } else {\n          parent.setAttribute(LISTEN_FLAG, listenerCount);\n        }\n      }\n    }\n\n    const index = listeners.indexOf(this);\n    if (index !== -1) {\n      listeners.splice(index, 1);\n    }\n\n    if (listeners.length === 0 && typeof window !== 'undefined') {\n      off(window, 'resize', finalLazyLoadHandler, passiveEvent);\n      off(window, 'scroll', finalLazyLoadHandler, passiveEvent);\n    }\n  }\n\n  render() {\n    //console.log('lazyload render');\n    if(this.state.visible) {\n      if(this.props.hiddenIfInvisible)\n        return this.state.hidden ?\n            <div style={{visibility: 'hidden'}}>{this.props.children}</div> :\n            <div>{this.props.children}</div>;\n      else\n        return this.props.children;\n    }\n    else\n      return this.props.placeholder ?\n                this.props.placeholder :\n                <div style={{ height: this.props.height }} className=\"lazyload-placeholder\" />;\n  }\n}\n\nLazyLoad.propTypes = {\n  once: PropTypes.bool,\n  height: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  offset: PropTypes.oneOfType([PropTypes.number, PropTypes.arrayOf(PropTypes.number)]),\n  overflow: PropTypes.bool,\n  resize: PropTypes.bool,\n  scroll: PropTypes.bool,\n  children: PropTypes.node,\n  throttle: PropTypes.oneOfType([PropTypes.number, PropTypes.bool]),\n  debounce: PropTypes.oneOfType([PropTypes.number, PropTypes.bool]),\n  placeholder: PropTypes.node,\n  scrollContainer: PropTypes.oneOfType([PropTypes.string, PropTypes.object]),\n  unmountIfInvisible: PropTypes.bool,\n  hiddenIfInvisible: PropTypes.bool,\n};\n\nLazyLoad.defaultProps = {\n  once: false,\n  offset: 0,\n  overflow: false,\n  resize: false,\n  scroll: true,\n  unmountIfInvisible: false,\n  hiddenIfInvisible: false,\n};\n\nconst getDisplayName = WrappedComponent => WrappedComponent.displayName || WrappedComponent.name || 'Component';\n\nconst decorator = (options = {}) => function lazyload(WrappedComponent) {\n  return class LazyLoadDecorated extends Component {\n    constructor() {\n      super();\n      this.displayName = `LazyLoad${getDisplayName(WrappedComponent)}`;\n    }\n\n    render() {\n      return (\n        <LazyLoad {...options}>\n          <WrappedComponent {...this.props} />\n        </LazyLoad>\n      );\n    }\n  };\n};\n\nexport { decorator as lazyload };\nexport default LazyLoad;\nexport { lazyLoadHandler as forceCheck };\n","export default function debounce(func, wait, immediate) {\n  let timeout;\n  let args;\n  let context;\n  let timestamp;\n  let result;\n\n  const later = function later() {\n    const last = +(new Date()) - timestamp;\n\n    if (last < wait && last >= 0) {\n      timeout = setTimeout(later, wait - last);\n    } else {\n      timeout = null;\n      if (!immediate) {\n        result = func.apply(context, args);\n        if (!timeout) {\n          context = null;\n          args = null;\n        }\n      }\n    }\n  };\n\n  return function debounced() {\n    context = this;\n    args = arguments;\n    timestamp = +(new Date());\n\n    const callNow = immediate && !timeout;\n    if (!timeout) {\n      timeout = setTimeout(later, wait);\n    }\n\n    if (callNow) {\n      result = func.apply(context, args);\n      context = null;\n      args = null;\n    }\n\n    return result;\n  };\n}\n","/*eslint-disable */\nexport default function throttle(fn, threshhold, scope) {\n  threshhold || (threshhold = 250);\n  var last,\n      deferTimer;\n  return function () {\n    var context = scope || this;\n\n    var now = +new Date,\n        args = arguments;\n    if (last && now < last + threshhold) {\n      // hold on to it\n      clearTimeout(deferTimer);\n      deferTimer = setTimeout(function () {\n        last = now;\n        fn.apply(context, args);\n      }, threshhold);\n    } else {\n      last = now;\n      fn.apply(context, args);\n    }\n  };\n}\n","import React, { PureComponent } from 'react';\nimport { THUHOLE_API_ROOT, get_json, API_VERSION_PARAM } from './flows_api';\nimport { Time } from './Common';\n\nexport class MessageViewer extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading_status: 'idle',\n      msg: [],\n    };\n  }\n\n  componentDidMount() {\n    this.load();\n  }\n\n  load() {\n    if (this.state.loading_status === 'loading') return;\n    this.setState(\n      {\n        loading_status: 'loading',\n      },\n      () => {\n        fetch(\n          THUHOLE_API_ROOT +\n            'api_xmcp/hole/system_msg?user_token=' +\n            encodeURIComponent(this.props.token) +\n            API_VERSION_PARAM(),\n        )\n          .then(get_json)\n          .then((json) => {\n            if (json.error) throw new Error(json.error);\n            else\n              this.setState({\n                loading_status: 'done',\n                msg: json.result,\n              });\n          })\n          .catch((err) => {\n            console.error(err);\n            alert('' + err);\n            this.setState({\n              loading_status: 'failed',\n            });\n          });\n      },\n    );\n  }\n\n  render() {\n    if (this.state.loading_status === 'loading')\n      return <p className=\"box box-tip\">加载中……</p>;\n    else if (this.state.loading_status === 'failed')\n      return (\n        <div className=\"box box-tip\">\n          <a\n            onClick={() => {\n              this.load();\n            }}\n          >\n            重新加载\n          </a>\n        </div>\n      );\n    else if (this.state.loading_status === 'done')\n      return this.state.msg.map((msg) => (\n        <div className=\"box\" key={msg.timestamp}>\n          <div className=\"box-header\">\n            <Time stamp={msg.timestamp} short={false} />\n            <b>{msg.title}</b>\n          </div>\n          <div className=\"box-content\">\n            <pre>{msg.content}</pre>\n          </div>\n        </div>\n      ));\n    else return null;\n  }\n}\n","import React, { PureComponent } from 'react';\n\nimport './Config.css';\nimport { HighlightedMarkdown } from './Common';\n\nconst BUILTIN_IMGS = {\n  'https://cdn.jsdelivr.net/gh/thuhole/webhole@gh-pages/static/bg/gbp.jpg':\n    '寻觅繁星（默认）',\n  'https://cdn.jsdelivr.net/gh/thuhole/webhole@gh-pages/static/bg/eriri.jpg':\n    '平成著名画师',\n  'https://cdn.jsdelivr.net/gh/thuhole/webhole@gh-pages/static/bg/yurucamp.jpg':\n    '露营天下第一',\n  'https://cdn.jsdelivr.net/gh/thuhole/webhole@gh-pages/static/bg/minecraft.jpg':\n    '麦恩·库拉夫特',\n  'https://cdn.jsdelivr.net/gh/thuhole/webhole@gh-pages/static/bg/cyberpunk.jpg':\n    '赛博城市',\n  'https://cdn.jsdelivr.net/gh/thuhole/webhole@gh-pages/static/bg/bj.jpg':\n    '城市的星光',\n  'https://cdn.jsdelivr.net/gh/thuhole/webhole@gh-pages/static/bg/sif.jpg':\n    '梦开始的地方',\n};\n\nconst DEFAULT_CONFIG = {\n  background_img:\n    'https://cdn.jsdelivr.net/gh/thuhole/webhole@gh-pages/static/bg/gbp.jpg',\n  background_color: '#113366',\n  pressure: false,\n  easter_egg: true,\n  color_scheme: 'default',\n  fold: true,\n  block_words: [],\n};\n\nexport function load_config() {\n  let config = Object.assign({}, DEFAULT_CONFIG);\n  let loaded_config;\n  try {\n    loaded_config = JSON.parse(localStorage['hole_config'] || '{}');\n  } catch (e) {\n    alert('设置加载失败，将重置为默认设置！\\n' + e);\n    delete localStorage['hole_config'];\n    loaded_config = {};\n  }\n\n  // unrecognized configs are removed\n  Object.keys(loaded_config).forEach((key) => {\n    if (config[key] !== undefined) config[key] = loaded_config[key];\n  });\n\n  console.log('config loaded', config);\n  window.config = config;\n}\nexport function save_config() {\n  localStorage['hole_config'] = JSON.stringify(window.config);\n  load_config();\n}\n\nexport function bgimg_style(img, color) {\n  if (img === undefined) img = window.config.background_img;\n  if (color === undefined) color = window.config.background_color;\n  return {\n    background: 'transparent center center',\n    backgroundImage: img === null ? 'unset' : 'url(\"' + encodeURI(img) + '\")',\n    backgroundColor: color,\n    backgroundSize: 'cover',\n  };\n}\n\nclass ConfigBackground extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      img: window.config.background_img,\n      color: window.config.background_color,\n    };\n  }\n\n  save_changes() {\n    this.props.callback({\n      background_img: this.state.img,\n      background_color: this.state.color,\n    });\n  }\n\n  on_select(e) {\n    let value = e.target.value;\n    this.setState(\n      {\n        img: value === '##other' ? '' : value === '##color' ? null : value,\n      },\n      this.save_changes.bind(this),\n    );\n  }\n  on_change_img(e) {\n    this.setState(\n      {\n        img: e.target.value,\n      },\n      this.save_changes.bind(this),\n    );\n  }\n  on_change_color(e) {\n    this.setState(\n      {\n        color: e.target.value,\n      },\n      this.save_changes.bind(this),\n    );\n  }\n\n  render() {\n    let img_select =\n      this.state.img === null\n        ? '##color'\n        : Object.keys(BUILTIN_IMGS).indexOf(this.state.img) === -1\n        ? '##other'\n        : this.state.img;\n    return (\n      <div>\n        <p>\n          <b>背景图片：</b>\n          <select\n            className=\"config-select\"\n            value={img_select}\n            onChange={this.on_select.bind(this)}\n          >\n            {Object.keys(BUILTIN_IMGS).map((key) => (\n              <option key={key} value={key}>\n                {BUILTIN_IMGS[key]}\n              </option>\n            ))}\n            <option value=\"##other\">输入图片网址……</option>\n            <option value=\"##color\">纯色背景……</option>\n          </select>\n          &nbsp;\n          <small>#background_img</small>&nbsp;\n          {img_select === '##other' && (\n            <input\n              type=\"url\"\n              placeholder=\"图片网址\"\n              value={this.state.img}\n              onChange={this.on_change_img.bind(this)}\n            />\n          )}\n          {img_select === '##color' && (\n            <input\n              type=\"color\"\n              value={this.state.color}\n              onChange={this.on_change_color.bind(this)}\n            />\n          )}\n        </p>\n        <div\n          className=\"bg-preview\"\n          style={bgimg_style(this.state.img, this.state.color)}\n        />\n      </div>\n    );\n  }\n}\n\nclass ConfigColorScheme extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      color_scheme: window.config.color_scheme,\n    };\n  }\n\n  save_changes() {\n    this.props.callback({\n      color_scheme: this.state.color_scheme,\n    });\n  }\n\n  on_select(e) {\n    let value = e.target.value;\n    this.setState(\n      {\n        color_scheme: value,\n      },\n      this.save_changes.bind(this),\n    );\n  }\n\n  render() {\n    return (\n      <div>\n        <p>\n          <b>夜间模式：</b>\n          <select\n            className=\"config-select\"\n            value={this.state.color_scheme}\n            onChange={this.on_select.bind(this)}\n          >\n            <option value=\"default\">跟随系统</option>\n            <option value=\"light\">始终浅色模式</option>\n            <option value=\"dark\">始终深色模式</option>\n          </select>\n          &nbsp;<small>#color_scheme</small>\n        </p>\n        <p className=\"config-description\">\n          选择浅色或深色模式，深色模式下将会调暗图片亮度\n        </p>\n      </div>\n    );\n  }\n}\n\nclass ConfigTextArea extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      [props.id]: window.config[props.id],\n    };\n  }\n\n  save_changes() {\n    this.props.callback({\n      [this.props.id]: this.props.sift(this.state[this.props.id]),\n    });\n  }\n\n  on_change(e) {\n    let value = this.props.parse(e.target.value);\n    this.setState(\n      {\n        [this.props.id]: value,\n      },\n      this.save_changes.bind(this),\n    );\n  }\n\n  render() {\n    return (\n      <div>\n        <label>\n          <p>\n            <b>{this.props.name}</b>&nbsp;<small>#{this.props.id}</small>\n          </p>\n          <p className=\"config-description\">{this.props.description}</p>\n          <textarea\n            name={'config-' + this.props.id}\n            id={`config-textarea-${this.props.id}`}\n            className=\"config-textarea\"\n            value={this.props.display(this.state[this.props.id])}\n            onChange={this.on_change.bind(this)}\n          />\n        </label>\n      </div>\n    );\n  }\n}\n\n/* class ConfigBlockWords extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      block_words: window.config.block_words,\n    };\n  }\n\n  save_changes() {\n    this.props.callback({\n      block_words: this.state.block_words.filter((v) => v),\n    });\n  }\n\n  on_change(e) {\n    // Filter out those blank lines\n    let value = e.target.value.split('\\n');\n    this.setState(\n      {\n        block_words: value,\n      },\n      this.save_changes.bind(this),\n    );\n  }\n\n  render() {\n    return (\n      <div>\n        <p>\n          {' '}\n          <b>设置屏蔽词 </b>\n        </p>\n        <p>\n          <textarea\n            className=\"block-words\"\n            value={this.state.block_words.join('\\n')}\n            onChange={this.on_change.bind(this)}\n          />\n        </p>\n      </div>\n    );\n  }\n} */\n\nclass ConfigSwitch extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      switch: window.config[this.props.id],\n    };\n  }\n\n  on_change(e) {\n    let val = e.target.checked;\n    this.setState(\n      {\n        switch: val,\n      },\n      () => {\n        this.props.callback({\n          [this.props.id]: val,\n        });\n      },\n    );\n  }\n\n  render() {\n    return (\n      <div>\n        <p>\n          <label>\n            <input\n              name={'config-' + this.props.id}\n              type=\"checkbox\"\n              checked={this.state.switch}\n              onChange={this.on_change.bind(this)}\n            />\n            &nbsp;<b>{this.props.name}</b>\n            &nbsp;<small>#{this.props.id}</small>\n          </label>\n        </p>\n        <p className=\"config-description\">{this.props.description}</p>\n      </div>\n    );\n  }\n}\n\nexport class ConfigUI extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.save_changes_bound = this.save_changes.bind(this);\n  }\n\n  save_changes(chg) {\n    console.log(chg);\n    Object.keys(chg).forEach((key) => {\n      window.config[key] = chg[key];\n    });\n    save_config();\n  }\n\n  reset_settings() {\n    if (window.confirm('重置所有设置？')) {\n      window.config = {};\n      save_config();\n      window.location.reload();\n    }\n  }\n\n  render() {\n    return (\n      <div>\n        <div className=\"box config-ui-header\">\n          <p>\n            这些功能仍在测试，可能不稳定（\n            <a onClick={this.reset_settings.bind(this)}>全部重置</a>）\n          </p>\n          <p>\n            <b>\n              修改设置后{' '}\n              <a\n                onClick={() => {\n                  window.location.reload();\n                }}\n              >\n                刷新页面\n              </a>{' '}\n              方可生效\n            </b>\n          </p>\n        </div>\n        <div className=\"box\">\n          <ConfigBackground\n            id=\"background\"\n            callback={this.save_changes_bound}\n          />\n          <hr />\n          <ConfigColorScheme\n            id=\"color-scheme\"\n            callback={this.save_changes_bound}\n          />\n          <hr />\n          {/* <ConfigBlockWords\n            id=\"block-words\"\n            callback={this.save_changes_bound}\n          /> */}\n          <ConfigTextArea\n            id=\"block_words\"\n            callback={this.save_changes_bound}\n            name=\"设置屏蔽词\"\n            description={'包含屏蔽词的树洞会被折叠，每行写一个屏蔽词'}\n            display={(array) => array.join('\\n')}\n            sift={(array) => array.filter((v) => v)}\n            parse={(string) => string.split('\\n')}\n          />\n          <hr />\n          <ConfigSwitch\n            callback={this.save_changes_bound}\n            id=\"pressure\"\n            name=\"快速返回\"\n            description=\"短暂按住 Esc 键或重压屏幕（3D Touch）可以快速返回或者刷新树洞\"\n          />\n          <hr />\n          <ConfigSwitch\n            callback={this.save_changes_bound}\n            id=\"easter_egg\"\n            name=\"允许彩蛋\"\n            description=\"在某些情况下显示彩蛋\"\n          />\n          <hr />\n          <ConfigSwitch\n            callback={this.save_changes_bound}\n            id=\"fold\"\n            name=\"折叠树洞\"\n            description=\"在时间线中折叠可能引起不适的树洞\"\n          />\n          {localStorage['hide_announcement'] && (\n            <div>\n              <hr />\n              <p>已隐藏的公告</p>\n              <div className=\"box flow-item box-announcement\">\n                <HighlightedMarkdown\n                  text={localStorage['hide_announcement']}\n                  color_picker={this.color_picker}\n                  show_pid={() => {}}\n                />\n                <a\n                  onClick={() => {\n                    delete localStorage['hide_announcement'];\n                    alert('已取消隐藏公告');\n                  }}\n                >\n                  [取消隐藏]\n                </a>\n              </div>\n            </div>\n          )}\n          <hr />\n          <p>\n            新功能建议或问题反馈请在&nbsp;\n            <a\n              href=\"https://github.com/thuhole/thuhole-go-backend/issues\"\n              target=\"_blank\"\n            >\n              GitHub <span className=\"icon icon-github\" />\n            </a>\n            &nbsp;提出。\n          </p>\n        </div>\n      </div>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport {\n  API_BASE,\n  SafeTextarea,\n  PromotionBar,\n  HighlightedMarkdown,\n} from './Common';\nimport { MessageViewer } from './Message';\nimport { LoginPopup } from './infrastructure/widgets';\nimport { ColorPicker } from './color_picker';\nimport { ConfigUI } from './Config';\nimport fixOrientation from 'fix-orientation';\nimport copy from 'copy-to-clipboard';\nimport { cache } from './cache';\nimport {\n  // API_VERSION_PARAM,\n  // THUHOLE_API_ROOT,\n  // API,\n  get_json,\n  token_param,\n} from './flows_api';\n\nimport './UserAction.css';\n\nconst BASE64_RATE = 4 / 3;\nconst MAX_IMG_DIAM = 8000;\nconst MAX_IMG_PX = 5000000;\nconst MAX_IMG_FILESIZE = 450000 * BASE64_RATE;\n\nexport const TokenCtx = React.createContext({\n  value: null,\n  set_value: () => {},\n});\n\n// class LifeInfoBox extends Component {\n//     constructor(props) {\n//         super(props);\n//         if(!window._life_info_cache)\n//             window._life_info_cache={};\n//         this.CACHE_TIMEOUT_S=15;\n//         this.state={\n//             today_info: this.cache_get('today_info'),\n//             card_balance: this.cache_get('card_balance'),\n//             net_balance: this.cache_get('net_balance'),\n//             mail_count: this.cache_get('mail_count'),\n//         };\n//         this.INTERNAL_NETWORK_FAILURE='_network_failure';\n//         this.API_NAME={\n//             today_info: 'hole/today_info',\n//             card_balance: 'isop/card_balance',\n//             net_balance: 'isop/net_balance',\n//             mail_count: 'isop/mail_count',\n//         };\n//     }\n//\n//     cache_get(key) {\n//         let cache_item=window._life_info_cache[key];\n//         if(!cache_item || (+new Date())-cache_item[0]>1000*this.CACHE_TIMEOUT_S)\n//             return null;\n//         else\n//             return cache_item[1];\n//     }\n//     cache_set(key,value) {\n//         if(!window._life_info_cache[key] || window._life_info_cache[key][1]!==value)\n//             window._life_info_cache[key]=[+new Date(),value];\n//     }\n//\n//     load(state_key) {\n//         this.setState({\n//             [state_key]: null,\n//         },()=>{\n//             fetch(\n//                 PKUHELPER_ROOT+'api_xmcp/'+this.API_NAME[state_key]\n//                 +'?user_token='+encodeURIComponent(this.props.token)\n//                 +API_VERSION_PARAM()\n//             )\n//                 .then(get_json)\n//                 .then((json)=>{\n//                     //console.log(json);\n//                     this.setState({\n//                         [state_key]: json,\n//                     });\n//                 })\n//                 .catch((e)=>{\n//                     this.setState({\n//                         [state_key]: {\n//                             errMsg: '网络错误 '+e,\n//                             errCode: this.INTERNAL_NETWORK_FAILURE,\n//                             success: false,\n//                         }\n//                     });\n//                 })\n//         });\n//     }\n//\n//     componentDidMount() {\n//         ['today_info','card_balance','net_balance','mail_count'].forEach((k)=>{\n//             if(!this.state[k])\n//                 this.load(k);\n//         });\n//     }\n//\n//     reload_all() {\n//         ['today_info','card_balance','net_balance','mail_count'].forEach((k)=>{\n//             this.load(k);\n//         });\n//     }\n//\n//     render_line(state_key,title,value_fn,action,url_fn,do_login) {\n//         let s=this.state[state_key];\n//         if(!s)\n//             return (\n//                 <tr>\n//                     <td>{title}</td>\n//                     <td>加载中……</td>\n//                     <td />\n//                 </tr>\n//             );\n//         else if(!s.success) {\n//             let type='加载失败';\n//             if(s.errCode===this.INTERNAL_NETWORK_FAILURE)\n//                 type='网络错误';\n//             else if(['E01','E02','E03'].indexOf(s.errCode)!==-1)\n//                 type='授权失效';\n//\n//             let details=JSON.stringify(s);\n//             if(s.errMsg)\n//                 details=s.errMsg;\n//             else if(s.error)\n//                 details=s.error;\n//\n//             return (\n//                 <tr>\n//                     <td>{title}</td>\n//                     <td className=\"life-info-error\">\n//                         <a onClick={()=>alert(details)}>{type}</a>\n//                     </td>\n//                     <td>\n//                         {type==='授权失效' ?\n//                             <a onClick={do_login}>\n//                                 <span className=\"icon icon-forward\" />&nbsp;重新登录\n//                             </a> :\n//                             <a onClick={()=>this.load(state_key)}>\n//                                 <span className=\"icon icon-forward\" />&nbsp;重试\n//                             </a>\n//                         }\n//                     </td>\n//                 </tr>\n//             )\n//         }\n//         else {\n//             this.cache_set(state_key,s);\n//\n//             return (\n//                 <tr>\n//                     <td>{title}</td>\n//                     <td>{value_fn(s)}</td>\n//                     <td>\n//                         <a href={url_fn(s)} target=\"_blank\">\n//                             <span className=\"icon icon-forward\" />&nbsp;{action}\n//                         </a>\n//                     </td>\n//                 </tr>\n//             );\n//         }\n//     }\n//\n//     render() {\n//         return (\n//             <LoginPopup token_callback={(t)=>{\n//                 this.props.set_token(t);\n//                 this.reload_all();\n//             }}>{(do_login)=>(\n//                 <div className=\"box\">\n//                     <table className=\"life-info-table\">\n//                         <tbody>\n//                             {this.render_line(\n//                                 'today_info',\n//                                 '今日',(s)=>s.info,\n//                                 '校历',(s)=>s.schedule_url,\n//                                 do_login,\n//                             )}\n//                             {this.render_line(\n//                                 'card_balance',\n//                                 '校园卡',(s)=>`余额￥${s.balance.toFixed(2)}`,\n//                                 '充值',()=>'https://virtualprod.alipay.com/educate/educatePcRecharge.htm?schoolCode=PKU&schoolName=',\n//                                 do_login,\n//                             )}\n//                             {this.render_line(\n//                                 'net_balance',\n//                                 '网费',(s)=>`余额￥${s.balance.toFixed(2)}`,\n//                                 '充值',()=>'https://its.pku.edu.cn/epay.jsp',\n//                                 do_login,\n//                             )}\n//                             {this.render_line(\n//                                 'mail_count',\n//                                 '邮件',(s)=>`未读 ${s.count} 封`,\n//                                 '查看',()=>'https://mail.pku.edu.cn/',\n//                                 do_login,\n//                             )}\n//                         </tbody>\n//                     </table>\n//                 </div>\n//             )}</LoginPopup>\n//         )\n//     }\n// }\nexport function DoUpdate() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.getRegistrations().then((registrations) => {\n      for (let registration of registrations) {\n        console.log('unregister', registration);\n        registration.unregister();\n      }\n    });\n  }\n  cache().clear();\n  setTimeout(() => {\n    window.location.reload(true);\n  }, 200);\n}\n\nexport function InfoSidebar(props) {\n  return (\n    <div>\n      <PromotionBar />\n      <LoginForm show_sidebar={props.show_sidebar} />\n      <div className=\"box list-menu\">\n        <a\n          onClick={() => {\n            props.show_sidebar('设置', <ConfigUI />);\n          }}\n        >\n          <span className=\"icon icon-settings\" />\n          <label>设置</label>\n        </a>\n        &nbsp;&nbsp;\n        <a href=\"https://thuhole.com/policy.html\" target=\"_blank\">\n          <span className=\"icon icon-textfile\" />\n          <label>树洞规范</label>\n        </a>\n        &nbsp;&nbsp;\n        <a\n          href=\"https://github.com/thuhole/thuhole-go-backend/issues\"\n          target=\"_blank\"\n        >\n          <span className=\"icon icon-github\" />\n          <label>意见反馈</label>\n        </a>\n      </div>\n      <div className=\"box help-desc-box\">\n        <p>\n          <a onClick={DoUpdate}>强制检查更新</a>\n          （当前版本：【{process.env.REACT_APP_BUILD_INFO || '---'}{' '}\n          {process.env.NODE_ENV}】 会自动在后台检查更新并在下次访问时更新）\n        </p>\n      </div>\n      <div className=\"box help-desc-box\">\n        <p>联系我们：thuhole at protonmail dot com</p>\n      </div>\n      <div className=\"box help-desc-box\">\n        <p>\n          T大树洞 网页版 by @thuhole， 基于&nbsp;\n          <a\n            href=\"https://www.gnu.org/licenses/gpl-3.0.zh-cn.html\"\n            target=\"_blank\"\n          >\n            GPLv3\n          </a>\n          &nbsp;协议在{' '}\n          <a href=\"https://github.com/thuhole/webhole\" target=\"_blank\">\n            GitHub\n          </a>{' '}\n          开源\n        </p>\n        <p>\n          T大树洞 网页版的诞生离不开&nbsp;\n          <a\n            href=\"https://github.com/pkuhelper-web/webhole\"\n            target=\"_blank\"\n            rel=\"noopener\"\n          >\n            P大树洞网页版 by @xmcp\n          </a>\n          、\n          <a href=\"https://reactjs.org/\" target=\"_blank\" rel=\"noopener\">\n            React\n          </a>\n          、\n          <a href=\"https://icomoon.io/#icons\" target=\"_blank\" rel=\"noopener\">\n            IcoMoon\n          </a>\n          &nbsp;等开源项目\n        </p>\n        <p>\n          This program is free software: you can redistribute it and/or modify\n          it under the terms of the GNU General Public License as published by\n          the Free Software Foundation, either version 3 of the License, or (at\n          your option) any later version.\n        </p>\n        <p>\n          This program is distributed in the hope that it will be useful, but\n          WITHOUT ANY WARRANTY; without even the implied warranty of\n          MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the&nbsp;\n          <a\n            href=\"https://www.gnu.org/licenses/gpl-3.0.zh-cn.html\"\n            target=\"_blank\"\n          >\n            GNU General Public License\n          </a>\n          &nbsp;for more details.\n        </p>\n      </div>\n    </div>\n  );\n}\n\n// class ResetUsertokenWidget extends Component {\n//   constructor(props) {\n//     super(props);\n//     this.state = {\n//       loading_status: 'done',\n//     };\n//   }\n//\n//   do_reset() {\n//     if (\n//       window.confirm(\n//         '您正在重置 UserToken！\\n您的账号将会在【所有设备】上注销，您需要手动重新登录！',\n//       )\n//     ) {\n//       let uid = window.prompt(\n//         '您正在重置 UserToken！\\n请输入您的学号以确认身份：',\n//       );\n//       if (uid)\n//         this.setState(\n//           {\n//             loading_status: 'loading',\n//           },\n//           () => {\n//             fetch(THUHOLE_API_ROOT + 'api_xmcp/hole/reset_usertoken', {\n//               method: 'post',\n//               headers: {\n//                 'Content-Type': 'application/json',\n//               },\n//               body: JSON.stringify({\n//                 user_token: this.props.token,\n//                 uid: uid,\n//               }),\n//             })\n//               .then(get_json)\n//               .then((json) => {\n//                 if (json.error) throw new Error(json.error);\n//                 else alert('重置成功！您需要在所有设备上重新登录。');\n//\n//                 this.setState({\n//                   loading_status: 'done',\n//                 });\n//               })\n//               .catch((e) => {\n//                 alert('重置失败：' + e);\n//                 this.setState({\n//                   loading_status: 'done',\n//                 });\n//               });\n//           },\n//         );\n//     }\n//   }\n//\n//   render() {\n//     if (this.state.loading_status === 'done')\n//       return <a onClick={this.do_reset.bind(this)}>重置</a>;\n//     else if (this.state.loading_status === 'loading')\n//       return (\n//         <a>\n//           <span className=\"icon icon-loading\" />\n//         </a>\n//       );\n//   }\n// }\n\nexport class LoginForm extends Component {\n  copy_token(token) {\n    if (copy(token))\n      alert(\n        '复制成功！\\n请一定不要泄露给其他人，或在thuhole.com以外的其他网站中输入token，否则可能会导致信息泄漏哦',\n      );\n  }\n\n  render() {\n    return (\n      <TokenCtx.Consumer>\n        {(token) => (\n          <div>\n            {/*{!!token.value &&*/}\n            {/*    <LifeInfoBox token={token.value} set_token={token.set_value} />*/}\n            {/*}*/}\n            <div className=\"login-form box\">\n              {token.value ? (\n                <div>\n                  <p>\n                    <b>您已登录。</b>\n                    <button\n                      type=\"button\"\n                      onClick={() => {\n                        token.set_value(null);\n                      }}\n                    >\n                      <span className=\"icon icon-logout\" /> 注销\n                    </button>\n                    <br />\n                  </p>\n                  {/*<p>*/}\n                  {/*根据计算中心要求，访问授权三个月内有效，过期需重新登录。*/}\n                  {/*T大树洞将会单向加密(i.e. 哈希散列)您的邮箱后再存入数据库，因此您的发帖具有较强的匿名性。具体可见我们的<a href=\"https://github.com/thuhole/thuhole-go-backend/blob/76f56e6b75257b59e552b6bdba77e114151fcad1/src/db.go#L184\">后端开源代码</a>。*/}\n                  {/*</p>*/}\n                  <p>\n                    <a\n                      onClick={() => {\n                        this.props.show_sidebar(\n                          '系统消息',\n                          <MessageViewer token={token.value} />,\n                        );\n                      }}\n                    >\n                      查看系统消息\n                    </a>\n                    <br />\n                    当您发送的内容违规时，我们将用系统消息提示您\n                  </p>\n                  <p>\n                    <a onClick={this.copy_token.bind(this, token.value)}>\n                      复制 User Token\n                    </a>\n                    <br />\n                    复制 User Token\n                    可以在新设备登录，切勿告知他人。若怀疑被盗号请重新邮箱验证码登录以重置Token。\n                    {/*，若怀疑被盗号请尽快 <ResetUsertokenWidget token={token.value} />*/}\n                  </p>\n                </div>\n              ) : (\n                <LoginPopup token_callback={token.set_value}>\n                  {(do_popup) => (\n                    <div>\n                      <p>\n                        <button type=\"button\" onClick={do_popup}>\n                          <span className=\"icon icon-login\" />\n                          &nbsp;登录\n                        </button>\n                      </p>\n                      <p>\n                        <small>\n                          T大树洞\n                          面向T大学生，通过T大邮箱验证您的身份并提供服务。\n                        </small>\n                      </p>\n                    </div>\n                  )}\n                </LoginPopup>\n              )}\n            </div>\n          </div>\n        )}\n      </TokenCtx.Consumer>\n    );\n  }\n}\n\n// export class ReplyForm extends Component {\n//   constructor(props) {\n//     super(props);\n//     this.state = {\n//       text: '',\n//       loading_status: 'done',\n//       preview: false,\n//     };\n//     this.on_change_bound = this.on_change.bind(this);\n//     this.area_ref = this.props.area_ref || React.createRef();\n//     this.global_keypress_handler_bound = this.global_keypress_handler.bind(\n//       this,\n//     );\n//     this.color_picker = new ColorPicker();\n//   }\n//\n//   global_keypress_handler(e) {\n//     if (\n//       e.code === 'Enter' &&\n//       !e.ctrlKey &&\n//       !e.altKey &&\n//       ['input', 'textarea'].indexOf(e.target.tagName.toLowerCase()) === -1\n//     ) {\n//       if (this.area_ref.current) {\n//         e.preventDefault();\n//         this.area_ref.current.focus();\n//       }\n//     }\n//   }\n//   componentDidMount() {\n//     document.addEventListener('keypress', this.global_keypress_handler_bound);\n//   }\n//   componentWillUnmount() {\n//     document.removeEventListener(\n//       'keypress',\n//       this.global_keypress_handler_bound,\n//     );\n//   }\n//\n//   on_change(value) {\n//     this.setState({\n//       text: value,\n//     });\n//   }\n//\n//   on_submit(event) {\n//     if (event) event.preventDefault();\n//     if (this.state.loading_status === 'loading') return;\n//     this.setState({\n//       loading_status: 'loading',\n//     });\n//\n//     let data = new URLSearchParams();\n//     data.append('pid', this.props.pid);\n//     data.append('text', this.state.text);\n//     data.append('user_token', this.props.token);\n//     fetch(\n//       API_BASE + '/api.php?action=docomment' + token_param(this.props.token),\n//       {\n//         method: 'POST',\n//         headers: {\n//           'Content-Type': 'application/x-www-form-urlencoded',\n//         },\n//         body: data,\n//       },\n//     )\n//       .then(get_json)\n//       .then((json) => {\n//         if (json.code !== 0) {\n//           if (json.msg) alert(json.msg);\n//           throw new Error(JSON.stringify(json));\n//         }\n//\n//         this.setState({\n//           loading_status: 'done',\n//           text: '',\n//           preview: false,\n//         });\n//         this.area_ref.current.clear();\n//         this.props.on_complete();\n//       })\n//       .catch((e) => {\n//         console.error(e);\n//         alert('回复失败');\n//         this.setState({\n//           loading_status: 'done',\n//         });\n//       });\n//   }\n//\n//   toggle_preview() {\n//     this.setState({\n//       preview: !this.state.preview,\n//     });\n//   }\n//\n//   render() {\n//     return (\n//       <form\n//         onSubmit={this.on_submit.bind(this)}\n//         className={'reply-form box' + (this.state.text ? ' reply-sticky' : '')}\n//       >\n//         {this.state.preview ? (\n//           <div className=\"reply-preview\">\n//             <HighlightedMarkdown\n//               text={this.state.text}\n//               color_picker={this.color_picker}\n//               show_pid={() => {}}\n//             />\n//           </div>\n//         ) : (\n//           <SafeTextarea\n//             ref={this.area_ref}\n//             id={this.props.pid}\n//             on_change={this.on_change_bound}\n//             on_submit={this.on_submit.bind(this)}\n//           />\n//         )}\n//         <button\n//           type=\"button\"\n//           onClick={() => {\n//             this.toggle_preview();\n//           }}\n//         >\n//           {this.state.preview ? (\n//             <span className=\"icon icon-eye-blocked\" />\n//           ) : (\n//             <span className=\"icon icon-eye\" />\n//           )}\n//         </button>\n//         {this.state.loading_status === 'loading' ? (\n//           <button disabled=\"disabled\">\n//             <span className=\"icon icon-loading\" />\n//           </button>\n//         ) : (\n//           <button type=\"submit\">\n//             <span className=\"icon icon-send\" />\n//           </button>\n//         )}\n//       </form>\n//     );\n//   }\n// }\n\nexport class PostForm extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      text: '',\n      loading_status: 'done',\n      img_tip: null,\n      preview: false,\n    };\n    this.img_ref = React.createRef();\n    this.area_ref = this.props.area_ref || React.createRef();\n    this.on_change_bound = this.on_change.bind(this);\n    this.on_img_change_bound = this.on_img_change.bind(this);\n    this.global_keypress_handler_bound = this.global_keypress_handler.bind(\n      this,\n    );\n    this.color_picker = new ColorPicker();\n  }\n\n  global_keypress_handler(e) {\n    if (\n      e.code === 'Enter' &&\n      !e.ctrlKey &&\n      !e.altKey &&\n      ['input', 'textarea'].indexOf(e.target.tagName.toLowerCase()) === -1\n    ) {\n      if (this.area_ref.current) {\n        e.preventDefault();\n        this.area_ref.current.focus();\n      }\n    }\n  }\n  componentDidMount() {\n    document.addEventListener('keypress', this.global_keypress_handler_bound);\n  }\n  componentWillUnmount() {\n    document.removeEventListener(\n      'keypress',\n      this.global_keypress_handler_bound,\n    );\n  }\n\n  on_change(value) {\n    this.setState({\n      text: value,\n    });\n  }\n\n  do_post(text, img) {\n    let data = new URLSearchParams();\n    if (this.props.action === 'docomment') {\n      data.append('pid', this.props.pid);\n    }\n    data.append('text', this.state.text);\n    data.append('type', img ? 'image' : 'text');\n    data.append('user_token', this.props.token);\n    if (img) data.append('data', img);\n\n    fetch(\n      API_BASE +\n        '/api.php?action=' +\n        this.props.action +\n        token_param(this.props.token),\n      {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/x-www-form-urlencoded',\n        },\n        body: data,\n      },\n    )\n      .then(get_json)\n      .then((json) => {\n        if (json.code !== 0) {\n          if (json.msg) alert(json.msg);\n          throw new Error(JSON.stringify(json));\n        }\n\n        this.setState({\n          loading_status: 'done',\n          text: '',\n          preview: false,\n        });\n        this.area_ref.current.clear();\n        this.props.on_complete();\n      })\n      .catch((e) => {\n        console.error(e);\n        alert('发表失败');\n        this.setState({\n          loading_status: 'done',\n        });\n      });\n  }\n\n  proc_img(file) {\n    return new Promise((resolve, reject) => {\n      function return_url(url) {\n        const idx = url.indexOf(';base64,');\n        if (idx === -1) throw new Error('img not base64 encoded');\n\n        return url.substr(idx + 8);\n      }\n\n      let reader = new FileReader();\n      function on_got_img(url) {\n        const image = new Image();\n        image.onload = () => {\n          let width = image.width;\n          let height = image.height;\n          let compressed = false;\n\n          if (width > MAX_IMG_DIAM) {\n            height = (height * MAX_IMG_DIAM) / width;\n            width = MAX_IMG_DIAM;\n            compressed = true;\n          }\n          if (height > MAX_IMG_DIAM) {\n            width = (width * MAX_IMG_DIAM) / height;\n            height = MAX_IMG_DIAM;\n            compressed = true;\n          }\n          if (height * width > MAX_IMG_PX) {\n            let rate = Math.sqrt((height * width) / MAX_IMG_PX);\n            height /= rate;\n            width /= rate;\n            compressed = true;\n          }\n          console.log('chosen img size', width, height);\n\n          let canvas = document.createElement('canvas');\n          let ctx = canvas.getContext('2d');\n          canvas.width = width;\n          canvas.height = height;\n          ctx.drawImage(image, 0, 0, width, height);\n\n          let quality_l = 0.1,\n            quality_r = 0.9,\n            quality,\n            new_url;\n          while (quality_r - quality_l >= 0.03) {\n            quality = (quality_r + quality_l) / 2;\n            new_url = canvas.toDataURL('image/jpeg', quality);\n            console.log(\n              quality_l,\n              quality_r,\n              'trying quality',\n              quality,\n              'size',\n              new_url.length,\n            );\n            if (new_url.length <= MAX_IMG_FILESIZE) quality_l = quality;\n            else quality_r = quality;\n          }\n          if (quality_l >= 0.101) {\n            console.log('chosen img quality', quality);\n            resolve({\n              img: return_url(new_url),\n              quality: quality,\n              width: Math.round(width),\n              height: Math.round(height),\n              compressed: compressed,\n            });\n          } else {\n            reject('图片过大，无法上传');\n          }\n        };\n        image.src = url;\n      }\n      reader.onload = (event) => {\n        fixOrientation(event.target.result, {}, (fixed_dataurl) => {\n          on_got_img(fixed_dataurl);\n        });\n      };\n      reader.readAsDataURL(file);\n    });\n  }\n\n  on_img_change() {\n    if (this.img_ref.current && this.img_ref.current.files.length)\n      this.setState(\n        {\n          img_tip: '（正在处理图片……）',\n        },\n        () => {\n          this.proc_img(this.img_ref.current.files[0])\n            .then((d) => {\n              this.setState({\n                img_tip:\n                  `（${d.compressed ? '压缩到' : '尺寸'} ${d.width}*${\n                    d.height\n                  } / ` +\n                  `质量 ${Math.floor(d.quality * 100)}% / ${Math.floor(\n                    d.img.length / BASE64_RATE / 1000,\n                  )}KB）`,\n              });\n            })\n            .catch((e) => {\n              this.setState({\n                img_tip: `图片无效：${e}`,\n              });\n            });\n        },\n      );\n    else\n      this.setState({\n        img_tip: null,\n      });\n  }\n\n  on_submit(event) {\n    if (event) event.preventDefault();\n    if (this.state.loading_status === 'loading') return;\n    if (this.img_ref.current.files.length) {\n      this.setState({\n        loading_status: 'processing',\n      });\n      this.proc_img(this.img_ref.current.files[0])\n        .then((d) => {\n          this.setState({\n            loading_status: 'loading',\n          });\n          this.do_post(this.state.text, d.img);\n        })\n        .catch((e) => {\n          alert(e);\n        });\n    } else {\n      this.setState({\n        loading_status: 'loading',\n      });\n      this.do_post(this.state.text, null);\n    }\n  }\n\n  toggle_preview() {\n    this.setState({\n      preview: !this.state.preview,\n    });\n  }\n\n  render() {\n    let replyClassName =\n      'reply-form box' + (this.state.text ? ' reply-sticky' : '');\n    return (\n      <form\n        onSubmit={this.on_submit.bind(this)}\n        className={\n          this.props.action === 'dopost' ? 'post-form box' : replyClassName\n        }\n      >\n        <div className=\"post-form-bar\">\n          <label>\n            {/*<a>上传图片</a>*/}\n            <span className={'post-upload'}>\n              <span className=\"icon icon-upload\" />\n              &nbsp;插入图片\n            </span>\n            <input\n              ref={this.img_ref}\n              type=\"file\"\n              accept=\"image/*\"\n              disabled={this.state.loading_status !== 'done'}\n              onChange={this.on_img_change_bound}\n            />\n          </label>\n\n          {this.state.preview ? (\n            <button\n              type=\"button\"\n              onClick={() => {\n                this.toggle_preview();\n              }}\n            >\n              <span className=\"icon icon-eye-blocked\" />\n              &nbsp;编辑\n            </button>\n          ) : (\n            <button\n              type=\"button\"\n              onClick={() => {\n                this.toggle_preview();\n              }}\n            >\n              <span className=\"icon icon-eye\" />\n              &nbsp;预览\n            </button>\n          )}\n\n          {this.state.loading_status !== 'done' ? (\n            <button disabled=\"disabled\">\n              <span className=\"icon icon-loading\" />\n              &nbsp;\n              {this.state.loading_status === 'processing' ? '处理' : '上传'}\n            </button>\n          ) : (\n            <button type=\"submit\">\n              <span className=\"icon icon-send\" />\n              &nbsp;发表\n            </button>\n          )}\n        </div>\n        {!!this.state.img_tip && (\n          <p className=\"post-form-img-tip\">\n            <a\n              onClick={() => {\n                this.img_ref.current.value = '';\n                this.on_img_change();\n              }}\n            >\n              删除图片\n            </a>\n            {this.state.img_tip}\n          </p>\n        )}\n        {this.state.preview ? (\n          <div\n            className={\n              this.props.action === 'dopost' ? 'post-preview' : 'reply-preview'\n            }\n          >\n            <HighlightedMarkdown\n              text={this.state.text}\n              color_picker={this.color_picker}\n              show_pid={() => {}}\n            />\n          </div>\n        ) : (\n          <SafeTextarea\n            ref={this.area_ref}\n            id={this.props.pid}\n            on_change={this.on_change_bound}\n            on_submit={this.on_submit.bind(this)}\n          />\n        )}\n        {this.props.action === 'dopost' && (\n          <p>\n            <small>\n              发帖前请阅读并同意\n              <a href=\"https://thuhole.com/policy.html\" target=\"_blank\">\n                树洞规范\n              </a>\n            </small>\n          </p>\n        )}\n      </form>\n    );\n  }\n}\n","import React, { PureComponent } from 'react';\nimport copy from 'copy-to-clipboard';\nimport { ColorPicker } from './color_picker';\nimport {\n  split_text,\n  NICKNAME_RE,\n  PID_RE,\n  URL_RE,\n  URL_PID_RE,\n} from './text_splitter';\nimport {\n  format_time,\n  build_highlight_re,\n  Time,\n  TitleLine,\n  HighlightedText,\n  ClickHandler,\n  ColoredSpan,\n  HighlightedMarkdown,\n} from './Common';\nimport './Flows.css';\nimport LazyLoad, { forceCheck } from './react-lazyload/src';\n// import { AudioWidget } from './AudioWidget';\nimport { TokenCtx, ReplyForm, PostForm, DoUpdate } from './UserAction';\n\nimport { API } from './flows_api';\nimport { cache } from './cache';\n\n// const localStorage['img_base_url'] = 'https://thimg.yecdn.com/';\n// const localStorage['img_base_url_bak'] = 'https://img2.thuhole.com/';\n// const AUDIO_BASE=THUHOLE_API_ROOT+'services/thuhole/audios/';\n\nconst CLICKABLE_TAGS = { a: true, audio: true };\nconst PREVIEW_REPLY_COUNT = 10;\n// const QUOTE_BLACKLIST=['23333','233333','66666','666666','10086','10000','100000','99999','999999','55555','555555'];\nconst QUOTE_BLACKLIST = [];\nlet fold_tags = [];\n// const FOLD_TAGS = [\n//   '性相关',\n//   '政治相关',\n//   // '性话题',\n//   // '政治话题',\n//   '折叠',\n//   'NSFW',\n//   '刷屏',\n//   '真实性可疑',\n//   // '用户举报较多',\n//   '举报较多',\n//   '重复内容',\n//   '引战',\n//   '未经证实的传闻',\n//   '令人不适',\n// ];\n\nwindow.LATEST_POST_ID = parseInt(localStorage['_LATEST_POST_ID'], 10) || 0;\n\nconst DZ_NAME = '洞主';\n\nfunction load_single_meta(show_sidebar, token) {\n  return async (pid, replace = false) => {\n    let color_picker = new ColorPicker();\n    let title_elem = '树洞 #' + pid;\n    show_sidebar(\n      title_elem,\n      <div className=\"box box-tip\">正在加载 #{pid}</div>,\n      replace ? 'replace' : 'push',\n    );\n    try {\n      let single = await API.get_single(pid, token);\n      single.data.variant = {};\n      let { data: replies } = await API.load_replies_with_cache(\n        pid,\n        token,\n        color_picker,\n        parseInt(single.data.reply),\n      );\n      show_sidebar(\n        title_elem,\n        <FlowSidebar\n          key={+new Date()}\n          info={single.data}\n          replies={replies.data}\n          attention={replies.attention}\n          token={token}\n          show_sidebar={show_sidebar}\n          color_picker={color_picker}\n          deletion_detect={localStorage['DELETION_DETECT'] === 'on'}\n        />,\n        'replace',\n      );\n    } catch (e) {\n      console.error(e);\n      show_sidebar(\n        title_elem,\n        <div className=\"box box-tip\">\n          <p>\n            <a onClick={() => load_single_meta(show_sidebar, token)(pid, true)}>\n              重新加载\n            </a>\n          </p>\n          <p>{'' + e}</p>\n        </div>,\n        'replace',\n      );\n    }\n  };\n}\n\nclass Reply extends PureComponent {\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    const replyContent = this.props.info.text;\n    const splitIdx = replyContent.indexOf(']');\n\n    const author = replyContent.substr(0, splitIdx + 1),\n      replyText = replyContent.substr(splitIdx + 2);\n    return (\n      <div\n        className={'flow-reply box'}\n        style={\n          this.props.info._display_color\n            ? {\n                '--box-bgcolor-light': this.props.info._display_color[0],\n                '--box-bgcolor-dark': this.props.info._display_color[1],\n              }\n            : null\n        }\n      >\n        <div className=\"box-header\">\n          <code className=\"box-id\">#{this.props.info.cid}</code>\n          {!!this.props.do_filter_name && (\n            <span\n              className=\"reply-header-badge clickable\"\n              onClick={() => {\n                this.props.do_filter_name(this.props.info.name);\n              }}\n            >\n              <span className=\"icon icon-locate\" />\n            </span>\n          )}\n          &nbsp;\n          {this.props.info.tag !== null && (\n            <span className=\"box-header-tag\">{this.props.info.tag}</span>\n          )}\n          <Time stamp={this.props.info.timestamp} short={false} />\n        </div>\n        <div className=\"box-content\">\n          <HighlightedMarkdown\n            author={author}\n            text={replyText}\n            color_picker={this.props.color_picker}\n            show_pid={this.props.show_pid}\n          />\n          {this.props.info.type === 'image' && (\n            <p className=\"img\">\n              {this.props.img_clickable ? (\n                <a\n                  className=\"no-underline\"\n                  href={localStorage['img_base_url'] + this.props.info.url}\n                  target=\"_blank\"\n                >\n                  <img\n                    src={localStorage['img_base_url'] + this.props.info.url}\n                    onError={(e) => {\n                      if (\n                        e.target.src ===\n                        localStorage['img_base_url'] + this.props.info.url\n                      ) {\n                        e.target.src =\n                          localStorage['img_base_url_bak'] +\n                          this.props.info.url;\n                      }\n                    }}\n                    alt={localStorage['img_base_url'] + this.props.info.url}\n                  />\n                </a>\n              ) : (\n                <img\n                  src={localStorage['img_base_url'] + this.props.info.url}\n                  onError={(e) => {\n                    if (\n                      e.target.src ===\n                      localStorage['img_base_url'] + this.props.info.url\n                    ) {\n                      e.target.src =\n                        localStorage['img_base_url_bak'] + this.props.info.url;\n                    }\n                  }}\n                  alt={localStorage['img_base_url'] + this.props.info.url}\n                />\n              )}\n            </p>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n\nclass FlowItem extends PureComponent {\n  constructor(props) {\n    super(props);\n  }\n\n  copy_link(event) {\n    event.preventDefault();\n    copy(\n      `${event.target.href}${\n        this.props.info.tag ? ' 【' + this.props.info.tag + '】' : ''\n      }\\n` +\n        `${this.props.info.text}${\n          this.props.info.type === 'image'\n            ? ' [图片]'\n            : this.props.info.type === 'audio'\n            ? ' [语音]'\n            : ''\n        }\\n` +\n        `（${format_time(new Date(this.props.info.timestamp * 1000))} ${\n          this.props.info.likenum\n        }关注 ${this.props.info.reply}回复）\\n` +\n        this.props.replies\n          .map(\n            (r) =>\n              (r.tag ? '【' + r.tag + '】' : '') +\n              r.text +\n              (r.type === 'image' ? ' [图片]' : ''),\n          )\n          .join('\\n'),\n    );\n  }\n\n  render() {\n    let props = this.props;\n    return (\n      <div className={'flow-item' + (props.is_quote ? ' flow-item-quote' : '')}>\n        {!!props.is_quote && (\n          <div className=\"quote-tip black-outline\">\n            <div>\n              <span className=\"icon icon-quote\" />\n            </div>\n            {/*<div>*/}\n            {/*  <small>提到</small>*/}\n            {/*</div>*/}\n          </div>\n        )}\n        <div className=\"box\">\n          {!!window.LATEST_POST_ID &&\n            parseInt(props.info.pid, 10) > window.LATEST_POST_ID && (\n              <div className=\"flow-item-dot\" />\n            )}\n          {!!this.props.attention && !this.props.cached && (\n            <div className=\"flow-item-dot\" />\n          )}\n          <div className=\"box-header\">\n            {!!this.props.do_filter_name && (\n              <span\n                className=\"reply-header-badge clickable\"\n                onClick={() => {\n                  this.props.do_filter_name(DZ_NAME);\n                }}\n              >\n                <span className=\"icon icon-locate\" />\n              </span>\n            )}\n            {!!parseInt(props.info.likenum, 10) && (\n              <span className=\"box-header-badge\">\n                {props.info.likenum}&nbsp;\n                <span\n                  className={\n                    'icon icon-' + (props.attention ? 'star-ok' : 'star')\n                  }\n                />\n              </span>\n            )}\n            {!!parseInt(props.info.reply, 10) && (\n              <span className=\"box-header-badge\">\n                {props.info.reply}&nbsp;\n                <span className=\"icon icon-reply\" />\n              </span>\n            )}\n            <code className=\"box-id\">\n              <a\n                href={'##' + props.info.pid}\n                onClick={this.copy_link.bind(this)}\n              >\n                #{props.info.pid}\n              </a>\n            </code>\n            &nbsp;\n            {props.info.tag !== null && props.info.tag !== '折叠' && (\n              <span className=\"box-header-tag\">{props.info.tag}</span>\n            )}\n            <Time stamp={props.info.timestamp} short={!props.img_clickable} />\n          </div>\n          <div className=\"box-content\">\n            <HighlightedMarkdown\n              text={props.info.text}\n              color_picker={props.color_picker}\n              show_pid={props.show_pid}\n            />\n            {props.info.type === 'image' && (\n              <p className=\"img\">\n                {props.img_clickable ? (\n                  <a\n                    className=\"no-underline\"\n                    href={localStorage['img_base_url'] + props.info.url}\n                    target=\"_blank\"\n                  >\n                    <img\n                      src={localStorage['img_base_url'] + props.info.url}\n                      onError={(e) => {\n                        if (\n                          e.target.src ===\n                          localStorage['img_base_url'] + props.info.url\n                        ) {\n                          e.target.src =\n                            localStorage['img_base_url_bak'] + props.info.url;\n                        }\n                      }}\n                      alt={localStorage['img_base_url'] + props.info.url}\n                    />\n                  </a>\n                ) : (\n                  <img\n                    src={localStorage['img_base_url'] + props.info.url}\n                    onError={(e) => {\n                      if (\n                        e.target.src ===\n                        localStorage['img_base_url'] + props.info.url\n                      ) {\n                        e.target.src =\n                          localStorage['img_base_url_bak'] + props.info.url;\n                      }\n                    }}\n                    alt={localStorage['img_base_url'] + props.info.url}\n                  />\n                )}\n              </p>\n            )}\n            {/*{props.info.type==='audio' && <AudioWidget src={AUDIO_BASE+props.info.url} />}*/}\n          </div>\n          {!!(props.attention && props.info.variant.latest_reply) && (\n            <p className=\"box-footer\">\n              最新回复{' '}\n              <Time stamp={props.info.variant.latest_reply} short={false} />\n            </p>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n\nclass FlowSidebar extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      attention: props.attention,\n      info: props.info,\n      replies: props.replies,\n      loading_status: 'done',\n      error_msg: null,\n      filter_name: null,\n      rev: false,\n    };\n    this.color_picker = props.color_picker;\n    this.syncState = props.sync_state || (() => {});\n    this.reply_ref = React.createRef();\n  }\n\n  set_variant(cid, variant) {\n    this.setState(\n      (prev) => {\n        if (cid)\n          return {\n            replies: prev.replies.map((reply) => {\n              if (reply.cid === cid)\n                return Object.assign({}, reply, {\n                  variant: Object.assign({}, reply.variant, variant),\n                });\n              else return reply;\n            }),\n          };\n        else\n          return {\n            info: Object.assign({}, prev.info, {\n              variant: Object.assign({}, prev.info.variant, variant),\n            }),\n          };\n      },\n      function () {\n        this.syncState({\n          info: this.state.info,\n          replies: this.state.replies,\n        });\n      },\n    );\n  }\n\n  load_replies(update_count = true) {\n    this.setState({\n      loading_status: 'loading',\n      error_msg: null,\n    });\n    API.load_replies(\n      this.state.info.pid,\n      this.props.token,\n      this.color_picker,\n      null,\n    )\n      .then((json) => {\n        this.setState(\n          (prev, props) => ({\n            replies: json.data,\n            info: update_count\n              ? Object.assign({}, prev.info, {\n                  reply: '' + json.data.length,\n                })\n              : prev.info,\n            attention: !!json.attention,\n            loading_status: 'done',\n            error_msg: null,\n          }),\n          () => {\n            this.syncState({\n              replies: this.state.replies,\n              attention: this.state.attention,\n              info: this.state.info,\n            });\n            if (this.state.replies.length)\n              this.set_variant(null, {\n                latest_reply: Math.max.apply(\n                  null,\n                  this.state.replies.map((r) => parseInt(r.timestamp)),\n                ),\n              });\n          },\n        );\n      })\n      .catch((e) => {\n        console.error(e);\n        this.setState({\n          replies: [],\n          loading_status: 'done',\n          error_msg: '' + e,\n        });\n      });\n  }\n\n  toggle_attention() {\n    this.setState({\n      loading_status: 'loading',\n    });\n    const next_attention = !this.state.attention;\n    API.set_attention(this.state.info.pid, next_attention, this.props.token)\n      .then((json) => {\n        this.setState({\n          loading_status: 'done',\n          attention: next_attention,\n        });\n        this.syncState({\n          attention: next_attention,\n        });\n      })\n      .catch((e) => {\n        this.setState({\n          loading_status: 'done',\n        });\n        alert('设置关注失败');\n        console.error(e);\n      });\n  }\n\n  report() {\n    let reason = prompt(`举报 #${this.state.info.pid} 的理由：`);\n    if (reason !== null) {\n      API.report(this.state.info.pid, reason, this.props.token)\n        .then((json) => {\n          if (json.code !== 0) {\n            // if (json.msg) alert(json.msg);\n            throw new Error(JSON.stringify(json));\n          }\n          alert('举报成功');\n        })\n        .catch((e) => {\n          alert('举报失败');\n          console.error(e);\n        });\n    }\n  }\n\n  set_filter_name(name) {\n    this.setState((prevState) => ({\n      filter_name: name === prevState.filter_name ? null : name,\n    }));\n  }\n\n  toggle_rev() {\n    this.setState((prevState) => ({ rev: !prevState.rev }), forceCheck);\n  }\n\n  show_reply_bar(name, event) {\n    if (this.reply_ref.current && !event.target.closest('a, .clickable')) {\n      let text = this.reply_ref.current.get();\n      if (\n        /^\\s*(?:Re (?:|洞主|(?:[A-Z][a-z]+ )?(?:[A-Z][a-z]+)|You Win(?: \\d+)?):)?\\s*$/.test(\n          text,\n        )\n      ) {\n        // text is nearly empty so we can replace it\n        let should_text = 'Re ' + name + ': ';\n        if (should_text === this.reply_ref.current.get())\n          this.reply_ref.current.set('');\n        else this.reply_ref.current.set(should_text);\n      }\n    }\n  }\n\n  render() {\n    if (this.state.loading_status === 'loading')\n      return <p className=\"box box-tip\">加载中……</p>;\n\n    let show_pid = load_single_meta(this.props.show_sidebar, this.props.token);\n\n    let replies_to_show = this.state.filter_name\n      ? this.state.replies.filter((r) => r.name === this.state.filter_name)\n      : this.state.replies.slice();\n    if (this.state.rev) replies_to_show.reverse();\n\n    // may not need key, for performance\n    // key for lazyload elem\n    // let view_mode_key =\n    //   (this.state.rev ? 'y-' : 'n-') + (this.state.filter_name || 'null');\n\n    let replies_cnt = { [DZ_NAME]: 1 };\n    replies_to_show.forEach((r) => {\n      if (replies_cnt[r.name] === undefined) replies_cnt[r.name] = 0;\n      replies_cnt[r.name]++;\n    });\n\n    // hide main thread when filtered\n    let main_thread_elem =\n      this.state.filter_name && this.state.filter_name !== DZ_NAME ? null : (\n        <ClickHandler\n          callback={(e) => {\n            this.show_reply_bar('', e);\n          }}\n        >\n          <FlowItem\n            info={this.state.info}\n            attention={this.state.attention}\n            img_clickable={true}\n            color_picker={this.color_picker}\n            show_pid={show_pid}\n            replies={this.state.replies}\n            set_variant={(variant) => {\n              this.set_variant(null, variant);\n            }}\n            do_filter_name={\n              replies_cnt[DZ_NAME] > 1 ? this.set_filter_name.bind(this) : null\n            }\n          />\n        </ClickHandler>\n      );\n\n    return (\n      <div className=\"flow-item-row sidebar-flow-item\">\n        <div className=\"box box-tip\">\n          {!!this.props.token && (\n            <span>\n              <a onClick={this.report.bind(this)}>\n                <span className=\"icon icon-flag\" />\n                <label>举报</label>\n              </a>\n              &nbsp;&nbsp;\n            </span>\n          )}\n          <a onClick={this.load_replies.bind(this)}>\n            <span className=\"icon icon-refresh\" />\n            <label>刷新</label>\n          </a>\n          {(this.state.replies.length >= 1 || this.state.rev) && (\n            <span>\n              &nbsp;&nbsp;\n              <a onClick={this.toggle_rev.bind(this)}>\n                <span className=\"icon icon-order-rev\" />\n                <label>{this.state.rev ? '还原' : '逆序'}</label>\n              </a>\n            </span>\n          )}\n          {!!this.props.token && (\n            <span>\n              &nbsp;&nbsp;\n              <a\n                onClick={() => {\n                  this.toggle_attention();\n                }}\n              >\n                {this.state.attention ? (\n                  <span>\n                    <span className=\"icon icon-star-ok\" />\n                    <label>已关注</label>\n                  </span>\n                ) : (\n                  <span>\n                    <span className=\"icon icon-star\" />\n                    <label>未关注</label>\n                  </span>\n                )}\n              </a>\n            </span>\n          )}\n        </div>\n        {!!this.state.filter_name && (\n          <div className=\"box box-tip flow-item filter-name-bar\">\n            <p>\n              <span style={{ float: 'left' }}>\n                <a\n                  onClick={() => {\n                    this.set_filter_name(null);\n                  }}\n                >\n                  还原\n                </a>\n              </span>\n              <span className=\"icon icon-locate\" />\n              &nbsp;当前只看&nbsp;\n              <ColoredSpan\n                colors={this.color_picker.get(this.state.filter_name)}\n              >\n                {this.state.filter_name}\n              </ColoredSpan>\n            </p>\n          </div>\n        )}\n        {!this.state.rev && main_thread_elem}\n        {!!this.state.error_msg && (\n          <div className=\"box box-tip flow-item\">\n            <p>回复加载失败</p>\n            <p>{this.state.error_msg}</p>\n          </div>\n        )}\n        {this.props.deletion_detect &&\n          parseInt(this.state.info.reply) > this.state.replies.length &&\n          !!this.state.replies.length && (\n            <div className=\"box box-tip flow-item box-danger\">\n              {parseInt(this.state.info.reply) - this.state.replies.length}{' '}\n              条回复被删除\n            </div>\n          )}\n        {replies_to_show.map((reply, i) => (\n          <LazyLoad\n            key={i}\n            offset={1500}\n            height=\"5em\"\n            overflow={true}\n            once={true}\n          >\n            <ClickHandler\n              callback={(e) => {\n                this.show_reply_bar(reply.name, e);\n              }}\n            >\n              <Reply\n                info={reply}\n                color_picker={this.color_picker}\n                show_pid={show_pid}\n                set_variant={(variant) => {\n                  this.set_variant(reply.cid, variant);\n                }}\n                img_clickable={true}\n                do_filter_name={\n                  replies_cnt[reply.name] > 1\n                    ? this.set_filter_name.bind(this)\n                    : null\n                }\n              />\n            </ClickHandler>\n          </LazyLoad>\n        ))}\n        {this.state.rev && main_thread_elem}\n        {this.props.token ? (\n          <PostForm\n            pid={this.state.info.pid}\n            token={this.props.token}\n            action={'docomment'}\n            area_ref={this.reply_ref}\n            on_complete={this.load_replies.bind(this)}\n          />\n        ) : (\n          <div className=\"box box-tip flow-item\">登录后可以回复树洞</div>\n        )}\n      </div>\n    );\n  }\n}\n\nclass FlowItemRow extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.needFold =\n      fold_tags.indexOf(props.info.tag) > -1 &&\n      (props.search_param === '热榜' || !props.search_param) &&\n      window.config.fold &&\n      props.mode !== 'attention' &&\n      props.mode !== 'attention_finished';\n    this.state = {\n      replies: [],\n      reply_status: 'done',\n      reply_error: null,\n      info: Object.assign({}, props.info, { variant: {} }),\n      hidden:\n        window.config.block_words.some((word) =>\n          props.info.text.includes(word),\n        ) || this.needFold,\n      attention:\n        props.attention_override === null ? false : props.attention_override,\n      cached: true, // default no display anything\n    };\n    this.color_picker = new ColorPicker();\n  }\n\n  componentDidMount() {\n    if (parseInt(this.state.info.reply, 10)) {\n      this.load_replies(null, /*update_count=*/ false);\n    }\n  }\n\n  // reveal() {\n  //   this.setState({ hidden: false });\n  // }\n\n  load_replies(callback, update_count = true) {\n    console.log('fetching reply', this.state.info.pid);\n    this.setState({\n      reply_status: 'loading',\n      reply_error: null,\n    });\n    API.load_replies_with_cache(\n      this.state.info.pid,\n      this.props.token,\n      this.color_picker,\n      parseInt(this.state.info.reply),\n    )\n      .then(({ data: json, cached }) => {\n        this.setState(\n          (prev, props) => ({\n            replies: json.data,\n            info: Object.assign({}, prev.info, {\n              reply: update_count ? '' + json.data.length : prev.info.reply,\n              variant: json.data.length\n                ? {\n                    latest_reply: Math.max.apply(\n                      null,\n                      json.data.map((r) => parseInt(r.timestamp)),\n                    ),\n                  }\n                : {},\n            }),\n            attention: !!json.attention,\n            reply_status: 'done',\n            reply_error: null,\n            cached,\n          }),\n          callback,\n        );\n      })\n      .catch((e) => {\n        console.error(e);\n        this.setState(\n          {\n            replies: [],\n            reply_status: 'failed',\n            reply_error: '' + e,\n          },\n          callback,\n        );\n      });\n  }\n\n  show_sidebar() {\n    this.props.show_sidebar(\n      '树洞 #' + this.state.info.pid,\n      <FlowSidebar\n        key={+new Date()}\n        info={this.state.info}\n        replies={this.state.replies}\n        attention={this.state.attention}\n        sync_state={this.setState.bind(this)}\n        token={this.props.token}\n        show_sidebar={this.props.show_sidebar}\n        color_picker={this.color_picker}\n        deletion_detect={this.props.deletion_detect}\n      />,\n    );\n  }\n\n  render() {\n    let show_pid = load_single_meta(this.props.show_sidebar, this.props.token, [\n      this.state.info.pid,\n    ]);\n\n    let hl_rules = [\n      ['url_pid', URL_PID_RE],\n      ['url', URL_RE],\n      ['pid', PID_RE],\n      ['nickname', NICKNAME_RE],\n    ];\n    if (this.props.search_param) {\n      hl_rules.push([\n        'search',\n        !!this.props.search_param.match(/\\/.+\\//)\n          ? build_highlight_re(this.props.search_param, ' ', 'gi', true) // Use regex\n          : build_highlight_re(this.props.search_param, ' ', 'gi'), // Don't use regex\n      ]);\n    }\n    let parts = split_text(this.state.info.text, hl_rules);\n\n    let quote_id = null;\n    if (!this.props.is_quote)\n      for (let [mode, content] of parts) {\n        content = content.length > 0 ? content.substring(1) : content;\n        if (\n          mode === 'pid' &&\n          QUOTE_BLACKLIST.indexOf(content) === -1 &&\n          parseInt(content) < parseInt(this.state.info.pid)\n        )\n          if (quote_id === null) quote_id = parseInt(content);\n          else {\n            quote_id = null;\n            break;\n          }\n      }\n\n    let res = (\n      <div\n        className={\n          'flow-item-row flow-item-row-with-prompt' +\n          (this.props.is_quote ? ' flow-item-row-quote' : '')\n        }\n        onClick={(event) => {\n          if (!CLICKABLE_TAGS[event.target.tagName.toLowerCase()])\n            this.show_sidebar();\n        }}\n      >\n        <FlowItem\n          parts={parts}\n          info={this.state.info}\n          attention={this.state.attention}\n          img_clickable={false}\n          is_quote={this.props.is_quote}\n          color_picker={this.color_picker}\n          show_pid={show_pid}\n          replies={this.state.replies}\n          cached={this.state.cached}\n        />\n        <div className=\"flow-reply-row\">\n          {this.state.reply_status === 'loading' && (\n            <div className=\"box box-tip\">加载中</div>\n          )}\n          {this.state.reply_status === 'failed' && (\n            <div className=\"box box-tip\">\n              <p>\n                <a\n                  onClick={() => {\n                    this.load_replies();\n                  }}\n                >\n                  重新加载评论\n                </a>\n              </p>\n              <p>{this.state.reply_error}</p>\n            </div>\n          )}\n          {this.state.replies.slice(0, PREVIEW_REPLY_COUNT).map((reply) => (\n            <Reply\n              key={reply.cid}\n              info={reply}\n              img_clickable={false}\n              color_picker={this.color_picker}\n              show_pid={show_pid}\n            />\n          ))}\n          {this.state.replies.length > PREVIEW_REPLY_COUNT && (\n            <div className=\"box box-tip\">\n              还有 {this.state.replies.length - PREVIEW_REPLY_COUNT} 条\n            </div>\n          )}\n        </div>\n      </div>\n    );\n\n    if (this.state.hidden) {\n      return (\n        <div\n          className=\"flow-item-row flow-item-row-with-prompt\"\n          onClick={(event) => {\n            if (!CLICKABLE_TAGS[event.target.tagName.toLowerCase()])\n              this.show_sidebar();\n          }}\n        >\n          <div\n            className={\n              'flow-item' + (this.props.is_quote ? ' flow-item-quote' : '')\n            }\n          >\n            {!!this.props.is_quote && (\n              <div className=\"quote-tip black-outline\">\n                <div>\n                  <span className=\"icon icon-quote\" />\n                </div>\n                {/*<div>*/}\n                {/*  <small>提到</small>*/}\n                {/*</div>*/}\n              </div>\n            )}\n            <div className=\"box\">\n              <div className=\"box-header\">\n                {!!this.props.do_filter_name && (\n                  <span\n                    className=\"reply-header-badge clickable\"\n                    onClick={() => {\n                      this.props.do_filter_name(DZ_NAME);\n                    }}\n                  >\n                    <span className=\"icon icon-locate\" />\n                  </span>\n                )}\n                <code className=\"box-id\">#{this.props.info.pid}</code>\n                &nbsp;\n                {this.props.info.tag !== null &&\n                  this.props.info.tag !== '折叠' && (\n                    <span className=\"box-header-tag\">\n                      {this.props.info.tag}\n                    </span>\n                  )}\n                <Time stamp={this.props.info.timestamp} short={true} />\n                <span className=\"box-header-badge\">\n                  {this.needFold ? '已隐藏' : '已屏蔽'}\n                </span>\n                <div style={{ clear: 'both' }} />\n              </div>\n            </div>\n          </div>\n        </div>\n      );\n    }\n\n    return quote_id ? (\n      <div>\n        {res}\n        <FlowItemQuote\n          pid={quote_id}\n          show_sidebar={this.props.show_sidebar}\n          token={this.props.token}\n          deletion_detect={this.props.deletion_detect}\n        />\n      </div>\n    ) : (\n      res\n    );\n  }\n}\n\nclass FlowItemQuote extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading_status: 'empty',\n      error_msg: null,\n      info: null,\n    };\n  }\n\n  componentDidMount() {\n    this.load();\n  }\n\n  load() {\n    this.setState(\n      {\n        loading_status: 'loading',\n      },\n      () => {\n        API.get_single(this.props.pid, this.props.token)\n          .then((json) => {\n            this.setState({\n              loading_status: 'done',\n              info: json.data,\n            });\n          })\n          .catch((err) => {\n            if (('' + err).indexOf('没有这条树洞') !== -1)\n              this.setState({\n                loading_status: 'empty',\n              });\n            else\n              this.setState({\n                loading_status: 'error',\n                error_msg: '' + err,\n              });\n          });\n      },\n    );\n  }\n\n  render() {\n    if (this.state.loading_status === 'empty') return null;\n    else if (this.state.loading_status === 'loading')\n      return (\n        <div className=\"aux-margin\">\n          <div className=\"box box-tip\">\n            <span className=\"icon icon-loading\" />\n            提到了 #{this.props.pid}\n          </div>\n        </div>\n      );\n    else if (this.state.loading_status === 'error')\n      return (\n        <div className=\"aux-margin\">\n          <div className=\"box box-tip\">\n            <p>\n              <a onClick={this.load.bind(this)}>重新加载</a>\n            </p>\n            <p>{this.state.error_msg}</p>\n          </div>\n        </div>\n      );\n    // 'done'\n    else\n      return (\n        <FlowItemRow\n          info={this.state.info}\n          mode={this.props.mode}\n          show_sidebar={this.props.show_sidebar}\n          token={this.props.token}\n          is_quote={true}\n          deletion_detect={this.props.deletion_detect}\n        />\n      );\n  }\n}\n\nfunction FlowChunk(props) {\n  return (\n    <TokenCtx.Consumer>\n      {({ value: token }) => (\n        <div className=\"flow-chunk\">\n          {!!props.title && <TitleLine text={props.title} />}\n          {props.list.map((info, ind) => (\n            <LazyLoad\n              key={info.pid}\n              offset={500}\n              height=\"15em\"\n              hiddenIfInvisible={false}\n            >\n              <div>\n                {!!(\n                  props.deletion_detect &&\n                  props.mode === 'list' &&\n                  ind &&\n                  props.list[ind - 1].pid - info.pid > 1\n                ) && (\n                  <div className=\"flow-item-row\">\n                    <div className=\"box box-tip flow-item box-danger\">\n                      {props.list[ind - 1].pid - info.pid - 1} 条被删除\n                    </div>\n                  </div>\n                )}\n                <FlowItemRow\n                  info={info}\n                  mode={props.mode}\n                  show_sidebar={props.show_sidebar}\n                  token={token}\n                  attention_override={\n                    props.mode === 'attention_finished' ? true : null\n                  }\n                  deletion_detect={props.deletion_detect}\n                  search_param={props.search_param}\n                />\n              </div>\n            </LazyLoad>\n          ))}\n        </div>\n      )}\n    </TokenCtx.Consumer>\n  );\n}\n\nexport class Flow extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      mode: props.mode,\n      search_param: props.search_text,\n      loaded_pages: 0,\n      chunks: {\n        title: '',\n        data: [],\n      },\n      announcement: '',\n      loading_status: 'done',\n      error_msg: null,\n    };\n    this.on_scroll_bound = this.on_scroll.bind(this);\n    window.LATEST_POST_ID = parseInt(localStorage['_LATEST_POST_ID'], 10) || 0;\n  }\n\n  load_page(page) {\n    const failed = (err) => {\n      console.error(err);\n      this.setState((prev, props) => ({\n        loaded_pages: prev.loaded_pages - 1,\n        loading_status: 'failed',\n        error_msg: '' + err,\n      }));\n    };\n\n    if (page > this.state.loaded_pages + 1) throw new Error('bad page');\n    if (page === this.state.loaded_pages + 1) {\n      console.log('fetching page', page);\n      if (this.state.mode === 'list') {\n        API.get_list(page, this.props.token)\n          .then((json) => {\n            let announcement = this.state.announcement;\n            if (page === 1 && json.data.length) {\n              // update latest_post_id\n              let max_id = -1;\n              json.data.forEach((x) => {\n                if (parseInt(x.pid, 10) > max_id) max_id = parseInt(x.pid, 10);\n              });\n              localStorage['_LATEST_POST_ID'] = '' + max_id;\n              if (json.config) {\n                localStorage['img_base_url'] = json.config.img_base_url;\n                localStorage['img_base_url_bak'] = json.config.img_base_url_bak;\n                fold_tags = JSON.stringify(json.config.fold_tags);\n                if (json.config.announcement) {\n                  announcement = json.config.announcement;\n                }\n                let versions_remote = json.config.web_frontend_version\n                  .substring(1)\n                  .split('.');\n                console.log('remote version:', versions_remote);\n                if (process.env.REACT_APP_BUILD_INFO) {\n                  let versions_local = process.env.REACT_APP_BUILD_INFO.substring(\n                    1,\n                  ).split('.');\n                  if (\n                    versions_remote[0] - versions_local[0] > 0 ||\n                    versions_remote[1] - versions_local[1] > 0 ||\n                    versions_remote[2] - versions_local[2] > 0\n                  ) {\n                    DoUpdate();\n                  }\n                }\n              }\n            }\n            this.setState((prev, props) => ({\n              chunks: {\n                title: 'News Feed',\n                data: prev.chunks.data.concat(\n                  json.data.filter(\n                    (x) =>\n                      prev.chunks.data.length === 0 ||\n                      !prev.chunks.data\n                        .slice(-100)\n                        .some((p) => p.pid === x.pid),\n                  ),\n                ),\n              },\n              announcement: announcement,\n              loading_status: 'done',\n            }));\n          })\n          .catch(failed);\n      } else if (this.state.mode === 'search') {\n        API.get_search(page, this.state.search_param, this.props.token)\n          .then((json) => {\n            const finished = json.data.length === 0;\n            this.setState((prev, props) => ({\n              chunks: {\n                title: 'Result for \"' + this.state.search_param + '\"',\n                data: prev.chunks.data.concat(\n                  json.data.filter(\n                    (x) =>\n                      prev.chunks.data.length === 0 ||\n                      !prev.chunks.data\n                        .slice(-100)\n                        .some((p) => p.pid === x.pid),\n                  ),\n                ),\n              },\n              mode: finished ? 'search_finished' : 'search',\n              loading_status: 'done',\n            }));\n          })\n          .catch(failed);\n      } else if (this.state.mode === 'single') {\n        const pid = parseInt(this.state.search_param.substr(1), 10);\n        API.get_single(pid, this.props.token)\n          .then((json) => {\n            this.setState({\n              chunks: {\n                title: 'PID = ' + pid,\n                data: [json.data],\n              },\n              mode: 'single_finished',\n              loading_status: 'done',\n            });\n          })\n          .catch(failed);\n      } else if (this.state.mode === 'attention') {\n        let use_search = !!this.state.search_param;\n        let use_regex = use_search && !!this.state.search_param.match(/\\/.+\\//);\n        let regex_search = /.+/;\n        if (use_regex) {\n          try {\n            regex_search = new RegExp(this.state.search_param.slice(1, -1));\n          } catch (e) {\n            alert(`请检查正则表达式合法性！\\n${e}`);\n            regex_search = /.+/;\n          }\n        }\n        console.log(use_search, use_regex);\n        API.get_attention(this.props.token)\n          .then((json) => {\n            this.setState({\n              chunks: {\n                title: `${\n                  use_search\n                    ? use_regex\n                      ? `Result for RegEx ${regex_search.toString()} in `\n                      : `Result for \"${this.state.search_param}\" in `\n                    : ''\n                }Attention List`,\n                data: !use_search\n                  ? json.data\n                  : !use_regex\n                  ? json.data.filter((post) => {\n                      return this.state.search_param\n                        .split(' ')\n                        .every((keyword) => post.text.includes(keyword));\n                    }) // Not using regex\n                  : json.data.filter((post) => !!post.text.match(regex_search)), // Using regex\n              },\n              mode: 'attention_finished',\n              loading_status: 'done',\n            });\n          })\n          .catch(failed);\n      } else {\n        console.log('nothing to load');\n        return;\n      }\n\n      this.setState((prev, props) => ({\n        loaded_pages: prev.loaded_pages + 1,\n        loading_status: 'loading',\n        error_msg: null,\n      }));\n    }\n  }\n\n  on_scroll(event) {\n    if (event.target === document) {\n      const avail =\n        document.body.scrollHeight - window.scrollY - window.innerHeight;\n      if (avail < window.innerHeight && this.state.loading_status === 'done')\n        this.load_page(this.state.loaded_pages + 1);\n    }\n  }\n\n  componentDidMount() {\n    this.load_page(1);\n    window.addEventListener('scroll', this.on_scroll_bound);\n    window.addEventListener('resize', this.on_scroll_bound);\n  }\n  componentWillUnmount() {\n    window.removeEventListener('scroll', this.on_scroll_bound);\n    window.removeEventListener('resize', this.on_scroll_bound);\n  }\n\n  render() {\n    const should_deletion_detect = localStorage['DELETION_DETECT'] === 'on';\n    let show_pid = load_single_meta(this.props.show_sidebar, this.props.token);\n    return (\n      <div className=\"flow-container\">\n        {this.state.announcement &&\n          this.state.announcement !== localStorage['hide_announcement'] && (\n            <div className=\"box flow-item box-announcement\">\n              <HighlightedMarkdown\n                text={this.state.announcement}\n                color_picker={this.color_picker}\n                show_pid={show_pid}\n              />\n              <a\n                onClick={() => {\n                  localStorage['hide_announcement'] = this.state.announcement;\n                  this.setState({ announcement: '' });\n                }}\n              >\n                [隐藏此公告]\n              </a>\n            </div>\n          )}\n        <FlowChunk\n          title={this.state.chunks.title}\n          list={this.state.chunks.data}\n          mode={this.state.mode}\n          search_param={this.state.search_param || null}\n          show_sidebar={this.props.show_sidebar}\n          deletion_detect={should_deletion_detect}\n        />\n        {this.state.loading_status === 'failed' && (\n          <div className=\"aux-margin\">\n            <div className=\"box box-tip\">\n              <p>\n                <a\n                  onClick={() => {\n                    this.load_page(this.state.loaded_pages + 1);\n                  }}\n                >\n                  重新加载\n                </a>\n              </p>\n              <p>{this.state.error_msg}</p>\n            </div>\n          </div>\n        )}\n        <TitleLine\n          text={\n            this.state.loading_status === 'loading' ? (\n              <span>\n                <span className=\"icon icon-loading\" />\n                &nbsp;Loading...\n              </span>\n            ) : (\n              '© thuhole'\n            )\n          }\n        />\n      </div>\n    );\n  }\n}\n","import React, { PureComponent } from 'react';\n// import {AppSwitcher} from './infrastructure/widgets';\nimport { InfoSidebar, PostForm } from './UserAction';\nimport { TokenCtx } from './UserAction';\n\nimport './Title.css';\n\nconst flag_re = /^\\/\\/setflag ([a-zA-Z0-9_]+)=(.*)$/;\n\nclass ControlBar extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      search_text: '',\n    };\n    this.set_mode = props.set_mode;\n\n    this.on_change_bound = this.on_change.bind(this);\n    this.on_keypress_bound = this.on_keypress.bind(this);\n    this.do_refresh_bound = this.do_refresh.bind(this);\n    this.do_attention_bound = this.do_attention.bind(this);\n  }\n\n  componentDidMount() {\n    if (window.location.hash) {\n      let text = decodeURIComponent(window.location.hash).substr(1);\n      if (text.lastIndexOf('?') !== -1)\n        text = text.substr(0, text.lastIndexOf('?')); // fuck wechat '#param?nsukey=...'\n      this.setState(\n        {\n          search_text: text,\n        },\n        () => {\n          this.on_keypress({ key: 'Enter' });\n        },\n      );\n    }\n  }\n\n  on_change(event) {\n    this.setState({\n      search_text: event.target.value,\n    });\n  }\n\n  on_keypress(event) {\n    if (event.key === 'Enter') {\n      let flag_res = flag_re.exec(this.state.search_text);\n      if (flag_res) {\n        if (flag_res[2]) {\n          localStorage[flag_res[1]] = flag_res[2];\n          alert(\n            'Set Flag ' +\n              flag_res[1] +\n              '=' +\n              flag_res[2] +\n              '\\nYou may need to refresh this webpage.',\n          );\n        } else {\n          delete localStorage[flag_res[1]];\n          alert(\n            'Clear Flag ' +\n              flag_res[1] +\n              '\\nYou may need to refresh this webpage.',\n          );\n        }\n        return;\n      }\n\n      const mode = this.state.search_text.startsWith('#')\n        ? 'single'\n        : this.props.mode !== 'attention'\n        ? 'search'\n        : 'attention';\n      this.set_mode(mode, this.state.search_text || '');\n    }\n  }\n\n  do_refresh() {\n    window.scrollTo(0, 0);\n    this.setState({\n      search_text: '',\n    });\n    this.set_mode('list', null);\n  }\n\n  do_attention() {\n    window.scrollTo(0, 0);\n    this.setState({\n      search_text: '',\n    });\n    this.set_mode('attention', null);\n  }\n\n  render() {\n    return (\n      <TokenCtx.Consumer>\n        {({ value: token }) => (\n          <div className=\"control-bar\">\n            <a\n              className=\"no-underline control-btn\"\n              onClick={this.do_refresh_bound}\n            >\n              <span className=\"icon icon-refresh\" />\n              <span className=\"control-btn-label\">最新</span>\n            </a>\n            {!!token && (\n              <a\n                className=\"no-underline control-btn\"\n                onClick={this.do_attention_bound}\n              >\n                <span className=\"icon icon-attention\" />\n                <span className=\"control-btn-label\">关注</span>\n              </a>\n            )}\n            <input\n              className=\"control-search\"\n              value={this.state.search_text}\n              placeholder={`${\n                this.props.mode === 'attention' ? '在关注列表中' : ''\n              }搜索 或 #树洞号`}\n              onChange={this.on_change_bound}\n              onKeyPress={this.on_keypress_bound}\n            />\n            <a\n              className=\"no-underline control-btn\"\n              onClick={() => {\n                this.props.show_sidebar(\n                  'T大树洞',\n                  <InfoSidebar show_sidebar={this.props.show_sidebar} />,\n                );\n              }}\n            >\n              <span className={'icon icon-' + (token ? 'about' : 'login')} />\n              <span className=\"control-btn-label\">\n                {token ? '账户' : '登录'}\n              </span>\n            </a>\n            {!!token && (\n              <a\n                className=\"no-underline control-btn\"\n                onClick={() => {\n                  this.props.show_sidebar(\n                    '发表树洞',\n                    <PostForm\n                      token={token}\n                      action={'dopost'}\n                      pid={'new_post'}\n                      on_complete={() => {\n                        this.props.show_sidebar(null, null, 'clear');\n                        this.do_refresh();\n                      }}\n                    />,\n                  );\n                }}\n              >\n                <span className=\"icon icon-plus\" />\n                <span className=\"control-btn-label\">发表</span>\n              </a>\n            )}\n          </div>\n        )}\n      </TokenCtx.Consumer>\n    );\n  }\n}\n\nexport function Title(props) {\n  return (\n    <div className=\"title-bar\">\n      {/* <AppSwitcher appid=\"hole\" /> */}\n      <div className=\"aux-margin\">\n        <div className=\"title\">\n          <p className=\"centered-line\">\n            <span\n              onClick={() =>\n                props.show_sidebar(\n                  'T大树洞',\n                  <InfoSidebar show_sidebar={props.show_sidebar} />,\n                )\n              }\n            >\n              T大树洞\n            </span>\n          </p>\n        </div>\n        <ControlBar\n          show_sidebar={props.show_sidebar}\n          set_mode={props.set_mode}\n          mode={props.mode}\n        />\n      </div>\n    </div>\n  );\n}\n","import React, { PureComponent } from 'react';\nimport './Sidebar.css';\n\nexport class Sidebar extends PureComponent {\n  constructor(props) {\n    super(props);\n    // this.sidebar_ref = React.createRef();\n    this.do_close_bound = this.do_close.bind(this);\n    this.do_back_bound = this.do_back.bind(this);\n  }\n\n  do_close() {\n    this.props.show_sidebar(null, null, 'clear');\n  }\n  do_back() {\n    this.props.show_sidebar(null, null, 'pop');\n  }\n\n  render() {\n    // hide old contents to remember state\n    let contents = this.props.stack.map(\n      ({ 1: content }, i) =>\n        content && (\n          <div\n            key={i}\n            className={\n              'sidebar-content ' +\n              (i === this.props.stack.length - 1\n                ? 'sidebar-content-show'\n                : 'sidebar-content-hide')\n            }\n          >\n            {content}\n          </div>\n        ),\n    );\n    let cur_title = this.props.stack[this.props.stack.length - 1][0];\n    return (\n      <div\n        className={\n          'sidebar-container ' +\n          (cur_title !== null ? 'sidebar-on' : 'sidebar-off')\n        }\n      >\n        <div\n          className=\"sidebar-shadow\"\n          onClick={this.do_back_bound}\n          onTouchEnd={(e) => {\n            e.preventDefault();\n            e.target.click();\n          }}\n        />\n        <div className=\"sidebar\">{contents}</div>\n        <div className=\"sidebar-title\">\n          <a className=\"no-underline\" onClick={this.do_close_bound}>\n            &nbsp;\n            <span className=\"icon icon-close\" />\n            &nbsp;\n          </a>\n          {this.props.stack.length > 2 && (\n            <a className=\"no-underline\" onClick={this.do_back_bound}>\n              &nbsp;\n              <span className=\"icon icon-back\" />\n              &nbsp;\n            </a>\n          )}\n          {cur_title}\n        </div>\n      </div>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport Pressure from 'pressure';\n\nimport './PressureHelper.css';\n\nconst THRESHOLD = 0.4;\nconst MULTIPLIER = 25;\nconst BORDER_WIDTH = 500; // also change css!\n\nexport class PressureHelper extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      level: 0,\n      fired: false,\n    };\n    this.callback = props.callback;\n    this.esc_interval = null;\n  }\n\n  do_fire() {\n    if (this.esc_interval) {\n      clearInterval(this.esc_interval);\n      this.esc_interval = null;\n    }\n    this.setState({\n      level: 1,\n      fired: true,\n    });\n    this.callback();\n    window.setTimeout(() => {\n      this.setState({\n        level: 0,\n        fired: false,\n      });\n    }, 300);\n  }\n\n  componentDidMount() {\n    if (window.config.pressure) {\n      Pressure.set(\n        document.body,\n        {\n          change: (force) => {\n            if (!this.state.fired) {\n              if (force >= 0.999) {\n                this.do_fire();\n              } else\n                this.setState({\n                  level: force,\n                });\n            }\n          },\n          end: () => {\n            this.setState({\n              level: 0,\n              fired: false,\n            });\n          },\n        },\n        {\n          polyfill: false,\n          only: 'touch',\n          preventSelect: false,\n        },\n      );\n\n      document.addEventListener('keydown', (e) => {\n        if (!e.repeat && e.key === 'Escape') {\n          if (this.esc_interval) clearInterval(this.esc_interval);\n          this.setState(\n            {\n              level: THRESHOLD / 2,\n            },\n            () => {\n              this.esc_interval = setInterval(() => {\n                let new_level = this.state.level + 0.1;\n                if (new_level >= 0.999) this.do_fire();\n                else\n                  this.setState({\n                    level: new_level,\n                  });\n              }, 30);\n            },\n          );\n        }\n      });\n      document.addEventListener('keyup', (e) => {\n        if (e.key === 'Escape') {\n          if (this.esc_interval) {\n            clearInterval(this.esc_interval);\n            this.esc_interval = null;\n          }\n          this.setState({\n            level: 0,\n          });\n        }\n      });\n    }\n  }\n\n  render() {\n    const pad = MULTIPLIER * (this.state.level - THRESHOLD) - BORDER_WIDTH;\n    return (\n      <div\n        className={\n          'pressure-box' +\n          (this.state.fired ? ' pressure-box-fired' : '') +\n          (this.state.level <= 0.0001 ? ' pressure-box-empty' : '')\n        }\n        style={{\n          left: pad,\n          right: pad,\n          top: pad,\n          bottom: pad,\n        }}\n      />\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport { Flow } from './Flows';\nimport { Title } from './Title';\nimport { Sidebar } from './Sidebar';\nimport { SwitchTransition, CSSTransition } from 'react-transition-group';\nimport { PressureHelper } from './PressureHelper';\nimport { TokenCtx } from './UserAction';\nimport { load_config, bgimg_style } from './Config';\nimport { listen_darkmode } from './infrastructure/functions';\nimport { LoginPopup, TitleLine } from './infrastructure/widgets';\nimport { cache } from './cache';\nimport './App.css';\n\nconst MAX_SIDEBAR_STACK_SIZE = 10;\n\nfunction DeprecatedAlert(props) {\n  return <div id=\"global-hint-container\" style={{ display: 'none' }} />;\n}\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    load_config();\n    listen_darkmode(\n      { default: undefined, light: false, dark: true }[\n        window.config.color_scheme\n      ],\n    );\n    this.state = {\n      sidebar_stack: [[null, null]], // list of [status, content]\n      mode: 'list', // list, single, search, attention\n      search_text: null,\n      flow_render_key: +new Date(),\n      token: localStorage['TOKEN'] || null,\n    };\n    this.show_sidebar_bound = this.show_sidebar.bind(this);\n    this.set_mode_bound = this.set_mode.bind(this);\n    this.on_pressure_bound = this.on_pressure.bind(this);\n    // a silly self-deceptive approach to ban guests, enough to fool those muggles\n    //                     document             cookie                    'pku_ip_flag=yes'\n    this.inthu_flag =\n      window[atob('ZG9jdW1lbnQ')][atob('Y29va2ll')].indexOf(\n        atob('dGh1X2lwX2ZsYWc9eWVz'),\n      ) !== -1;\n  }\n\n  static is_darkmode() {\n    if (window.config.color_scheme === 'dark') return true;\n    if (window.config.color_scheme === 'light') return false;\n    else {\n      // 'default'\n      return window.matchMedia('(prefers-color-scheme: dark)').matches;\n    }\n  }\n  componentDidMount() {\n    cache(); // init indexeddb\n  }\n\n  on_pressure() {\n    if (this.state.sidebar_stack.length > 1)\n      this.show_sidebar(null, null, 'clear');\n    else this.set_mode('list', null);\n  }\n\n  show_sidebar(title, content, mode = 'push') {\n    this.setState((prevState) => {\n      let ns = prevState.sidebar_stack.slice();\n      if (mode === 'push') {\n        if (ns.length === 1) {\n          document.body.style.top = `-${window.scrollY}px`;\n          document.body.style.position = 'fixed';\n          document.body.style.width = '100vw'; // Be responsive with fixed position\n        }\n        if (ns.length > MAX_SIDEBAR_STACK_SIZE) ns.splice(1, 1);\n        ns = ns.concat([[title, content]]);\n      } else if (mode === 'pop') {\n        if (ns.length === 1) return;\n        if (ns.length === 2) {\n          const scrollY = document.body.style.top;\n          document.body.style.position = '';\n          document.body.style.top = '';\n          document.body.style.width = '';\n          window.scrollTo(0, parseInt(scrollY || '0') * -1);\n        }\n        ns.pop();\n      } else if (mode === 'replace') {\n        ns.pop();\n        ns = ns.concat([[title, content]]);\n      } else if (mode === 'clear') {\n        const scrollY = document.body.style.top;\n        document.body.style.position = '';\n        document.body.style.top = '';\n        document.body.style.width = '';\n        window.scrollTo(0, parseInt(scrollY || '0') * -1);\n        ns = [[null, null]];\n      } else throw new Error('bad show_sidebar mode');\n      return {\n        sidebar_stack: ns,\n      };\n    });\n  }\n\n  set_mode(mode, search_text) {\n    this.setState({\n      mode: mode,\n      search_text: search_text,\n      flow_render_key: +new Date(),\n    });\n  }\n\n  render() {\n    return (\n      <TokenCtx.Provider\n        value={{\n          value: this.state.token,\n          set_value: (x) => {\n            localStorage['TOKEN'] = x || '';\n            this.setState({\n              token: x,\n            });\n          },\n        }}\n      >\n        <PressureHelper callback={this.on_pressure_bound} />\n        <div className=\"bg-img\" style={bgimg_style()} />\n        <Title\n          show_sidebar={this.show_sidebar_bound}\n          set_mode={this.set_mode_bound}\n          mode={this.state.mode}\n        />\n        <TokenCtx.Consumer>\n          {(token) => (\n            <div className=\"left-container\">\n              <DeprecatedAlert token={token.value} />\n              {!token.value && (\n                <div className=\"flow-item-row aux-margin\">\n                  <div className=\"box box-tip\">\n                    <p>\n                      <LoginPopup token_callback={token.set_value}>\n                        {(do_popup) => (\n                          <a onClick={do_popup}>\n                            <span className=\"icon icon-login\" />\n                            &nbsp;登录到 T大树洞\n                          </a>\n                        )}\n                      </LoginPopup>\n                    </p>\n                  </div>\n                </div>\n              )}\n              {this.inthu_flag || token.value ? (\n                <SwitchTransition mode=\"out-in\">\n                  <CSSTransition\n                    key={this.state.flow_render_key}\n                    timeout={100}\n                    classNames=\"flows-anim\"\n                  >\n                    <Flow\n                      key={this.state.flow_render_key}\n                      show_sidebar={this.show_sidebar_bound}\n                      mode={this.state.mode}\n                      search_text={this.state.search_text}\n                      token={token.value}\n                    />\n                  </CSSTransition>\n                </SwitchTransition>\n              ) : (\n                <TitleLine text=\"请登录后查看内容\" />\n              )}\n              <br />\n            </div>\n          )}\n        </TokenCtx.Consumer>\n        <Sidebar\n          show_sidebar={this.show_sidebar_bound}\n          stack={this.state.sidebar_stack}\n        />\n      </TokenCtx.Provider>\n    );\n  }\n}\n\nexport default App;\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/,\n    ),\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    // const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    // if (publicUrl.origin !== window.location.origin) {\n    // Our service worker won't work if PUBLIC_URL is on a different origin\n    // from what our page is served on. This might happen if a CDN is used to\n    // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n    // return;\n    // }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ',\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.',\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then((registration) => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n//import {elevate} from './infrastructure/elevator';\nimport registerServiceWorker from './registerServiceWorker';\n\n//elevate();\n\nReactDOM.render(<App />, document.getElementById('root'));\nregisterServiceWorker();\n","module.exports = \"data:image/png;base64,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\"","module.exports = \"data:image/png;base64,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\"","module.exports = \"data:image/png;base64,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\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAFdklEQVR42sVW+VNTVxS+f4Od9oeW0RmlU8dOcRx3BEHbqiio3dtfamds+0N1bGe62emirYpSLRYDguAWJQihLZBAEkgKgbCHgIBAXbBTtgSykhAQEL/ecyWtwwMHx9DemS/vvXvv+c73zj3n5DEAjHBodJz9MD7BvuP3KVbb0xqV1p6lzENzS9u7Y3zOVWNittXPMmvMWmaNjZgeW8OZY91i1pSbzSqcg6y01Lj7V7UOap3Bma9WhyiKtEyh0bGsQg0L+P3n5talDNZ5LpWZCwqYqqYxJk9TggK1Bkpza7pWrWNdsZHM/uKymZ1Pgvb07ohiel0Jy7VcO1ug0iCfc+WbW7fUa0vYrUw5u6G8IhXglR1l/qR45tu/l9WeTo5XGqvxS3k1tPmF+t6Y8MXOVYui+3ZEb+ROHoq+HVEb3WtCo23bIhZrCwoNuZyHuKpTU474v/2M+dOSmDdDJhVgzUxn1oQDcd7w59C5+00oqxqgsLTBnHAIQ8vnoy9uPbiDWYH2kk1dwmFkWdqRU2nG9V2vw8e5rScOx/ZnX5YK6Dvw6Z6+VzYMepY8hT8++ZALMONKfQuqkxLhWf88rNvCZy2A54KwqTp1UnCQgPZ9H8Cz5ElYX93gsR38/COpgO3r5bata+FYHYrKve8jp7EDuW23USRLQveKhXDERc5agCMuAt0rF6JQdkpw5DS1o3LPbsFti1nLIxQplx7BljVyO3fSExUG/YYVyFMVIa/lOvLfewcdyxbAvTNq1gJobzu3Ue16G3nNnCNfDUP0cvRELwX5IF9SAbERchtftO+MRsOKUKjXhUG9JRJlSxegm4fUvn32OUB7ycYYNh/qzRFQh4cJTuK23Y+kVED/1nA5BxycwMZxbWUoml4IQdemVXBujwStPQpc3KZr8yo0hYWglXMRJ3FPrksF2F57Sc4BK4f9jZfhfmuzgPPNTWLO9oggG7IN8BDnAzxSAaWL5sk58C+emMS8x8S0PFIBjQf3yznwH0EqwAfIOTAThqZgpjXf7CAV4PAMyjkwFXa3R1xHx+9i4h4wzn/o6r8zKtb6XW4MjdwBnxLw+ofF3HRcD2D2AlxeH5yDXpgsjdBWmFBcVY3S2jr0DTiEKN/wCFpu3ERReQUM1TW4+VcXfFxQ0AQMDvmFiPQcJb5PTkHi+Qs4cEqGo2fS0dndCxrFlVX4OvEkvvjxOCrMDSISQRMQgM3pgtXhFPd0lV3OxOmsKyICdByd3T04xkVVNFhw994cCPDwSIyMjQtyGhVms4hIt61fPA/wcz+WnjF3Alw8DygKvXYHbvf0IlmhgDy/QCQdCeviQuZUAL04kX/1UyK++TkJB2XJ+JMLIWd0DHMugEqNMrysrh6GmlocP3ceOlMlhkfHRA7MuYCByXoPDD0vucOnU2HlR0IOe/oHRBJSuU4EswoCjYjelOqeGhENpVaHhIyzounQcPNSjU87g/qWVvF83zYIAty+IdGI1GVGXCpQ4Te9ARnKXHx5/AQqLU3CWUNbu5g7kpomypOaFdmQ7WMLoPKjClCo1Dh54SJSMhVIy85BbXMLRnhUKNzUGU+cPYdsjRYpiixc4tVBzcsz9AgCXF7vQ3OAOiJlO139PBfG7k4IJ5Qb9Ka0RiUZ2PPQkua+JAKcfJIvzGhEZxwAOZ7aIzwPrLunrE/z3zLN90Brh9zu8vCmMsY3DIozDCYcHJTIlNTNHdelAorLTPG1lmbYuUrfCA/nsB+D/uDA679/fBSBWstVaPTGIxIBXX22EH151UVdqQn1V1sF6ppagoIAX6mpBhpD+YUSY9Uz0s/ygQFWXtPA1MXGjzUGo4Fv1HCoggRNkcGoLykz7fvdVMP0HBIB/xf+Bi8VajXQRja5AAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,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\"","module.exports = \"data:image/png;base64,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\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAC4jAAAuIwF4pT92AAAI1UlEQVR42mVXWW9W1xW9Ckh96Z+o+lKpeWv/Qd/6E1pFKkMYHEjEmHgKdiAljaCiRG2apEUhVYooDSWlBKehDKbYJoghBmMoYDBgMP6Ge+48nrO69rn3s42RtXTON/hba6+99zn7Ojt37XJ6enqW9/T2OCeOn3CePHjcY+L8tomzVgeI0yVIasQvIiHSajU1dBY38yi4eWdyYvOxw4edvr5+Z8eOHcsHBwcdp6e7e/mevXudC8PnX/Zn3dPGzxKjYm282FSIDLywRlDDJ7xFUNWq6td+BSNrwDUUKF1GXqxas0Nfn/zXD/spYmBw4CWn/+1+Z+TMhR8j0jPwCxiVGAFUDKioRsj3A64BV5/wFkERbr0SnuL36tWvERChEhEGeQid+vf/ffLED7q7u5c5p0588724EYzBL2HctDBeSvK0FlK7oOiCCrknlG+MqxbBJdrGtN1qrwSqdoCfBzUiiog9oyM3FxGhmjt96OBnjvNkauY38Apt3Jz2ESqDFeElqEAnvIjvRdYB+CGQF0CWLUIKpPU+J6KwciDwGLmA+4iCYq6JrG5pigCXL439zEFs5owqNVyxP2fuRQh/xEtrJHw/pjskDhMkM8/QODuG5sXLaI5+S3A/NsqVuDiKxtgIokcPYUKmymdqSG5ERGxhTKK0SV1tMs9kkfuVY7xSUwBtYwq8gjbnEHREMBXQLgWEGaJ7M3hyfBhq14cIXtkEf/1WBGs2IljbhWD9OvgbiQ0r4O/ahkK1YBI6EbqMXlUCEtZMysLMmBICOrnvQGkSCcoatLcWYToi2rQ/LaEu3YLbtR/JyHfQb/8O6OoGXt9ObAI2vQFs2QAMbEH05SE8PPInlM2nFMHCraznb1AAIzcZHci5L6MpR3uaURMUYlfPOrEghDWhW6yDXKM5dAX5rz5A8u5fkE89grk+CX1jEubGBPTEDZjJG4gnr+PBB4NIB19BcXMUKPn/cZvkSshZJxSQM/qCex2LADoxDysCHREWiiJarINMo/Hpf6FXH4R59zDzy5pIUuiIhRpJivhal3BvXEM8sBr4aBP0g3GYgv+bMA0ZXZCocxIVTEHJvY7vOyVfd9ARoedF1ELaGYooQ3PPOWDV36A/OcP0sUBbjMol2i5dalJQgtbZk8h+vRrm825+NkNC6fsqelNYkFwZrWsB4oTgeRG1ECWoaiOZC9HqvQDz6hD0PxhZTmdcn61ZH0xumwWWonHsIPRvV8B89R6JreX8LgUUBKPWJNG6EqANBYgj1hUrxFgsiNEoXbrAU9i/24b7xlWYrjGU59lmMe1vkrzFHxIXKKAIAjQ+3wt8vBL64ickZAFnro1cC7m2MCUFlKYWUNWFrQ1JkcW8EKmVNjuEbs8Nz6K99h6yjbeAaXYFDP9JDiS2LN0Aj5LUbaF1gNYfWYnizlGw2qDzNsmVJS8JHrWmMIrgaxFQu4S0FlEB1hUp1pwCNJugdVFhZkUD0YctzI5M4+mp/+HZ6Qk8O3MFz86N4tmFc5gbvwz/nzuQnX8LZThN4gBl6ZJYCbFFTgE5BeTyGrWAukUXwSwIooisbayIeCLH+Ef3cHPlTTxedRVPX/0ac+sPorn5fTQHtmL2wGZ4d0+hCB+RNEJB8oLkeUWMrIJJoUwGeY8CklrAizBI5PxwNX8QaE+HuPLlI9w60Mb1DRFub53DvW238bBvGI/fP4yZT/fBvXwYOceEQofIyzYyXZGmRhFcSZrAM7zvDVdk4kBcH9PR/HFd7xm5QIR4jRRH+qfx11/EuHOO2h+VaN/O4d7lz0z58B7OwW88Rcaiy2h7ysgTRp6QNCZ5LCsJI/vaMxEdiDsCoppwKewlxuhzWn/nO4XfrwvxZ562d77VUm+I2RlJTCQaCYsx4S0Y5wEiVnukhUzV4L4mtysdCCkg6ggIO2RLEMiVzgIsMoPR/7Swc02KfdsNHt/XiDgU+a4MOxpBUCKIMwRZgqAMEWgfAckquAiguBIkrGH4HkVISihAruyl8AUyZbH4Ct7Oxw41sHVliX07DdpNktuJjN8JNPyISAv4dMAvY/hGKHz4dMEjuU8RsvNlb1f5VMm3WA8U4HcIXwBJGGWalPjj/gZeW2Xw8R8YPQk5cVVjYSiTm+bNzZuyyHmpSolFsPEaoapEVOjs5V0ln7IuFgnwlqKaquDyHtg12MK6tQZH/l4i5bDU5meK0cu46LEGVF7y8sx5s7PB2K8KzLL256nVYhHsABHg2YKsBBjPqyYor9pbAUpJtAbTbL9t2xS6Xjc4M6zt5NX27IjIaY2Q6Y1XtVcW/PFMmsyWmWdN9uEtElH9UYIIsAXJecBTi0g7oBjOl3bEu3TJxZrXInRtAa5PUhRvX9cnoUzrMi6ySL2CDmhBVnW6lhoPbSpULaKTAkUHXPojEiIjAng50W6ZqGWst6uIcV2pcIOnszkG3svw2RFWPUldv4peSfRJNcdyqiMogGe/nHOedLmt844LC+mQFFCCpMBQAA+imLc6b0eO9pJ37VWjPmSy5tTNNACzc8yztJ5M5/JcIrmX4pOZ1dpvKgdMYbvbpgGVCwsibPlJBfCIEgfkLIi+caamnuz3fd6oHOcrcnnQWVwLjJxHsVc9l1jy+egl/4VAVy48JyB+XoTxjXWBIlxOwCE/G58c/7lzcujU9xuN5Bqvcsl7YUVUT1l2ZbvJs0gVuVjfyb08MnBMswP0Cw6kHQGMM7RHUt2aYn7OowpzYWPki6NfOHxIfMcZGjr7E450TV9EcFaY7wbOG4SN3iKsHLDkaZ1/cUALxIFS7riqG7Dggm1LE2jX+KUPiT2eOX/h/I/e3P7mS3xS7Vu+e/duihj+aauVXAkjW4zVpCWHDadqS9whn4++0wG1A6aTgrodq7tPMm3rXYoyoKBm0h45O3r25T179jh9/X3LnMHBd5z+/v7lvb19zrFjx52r1yZWR7EZJ7mm7cYKCJaQJ/VDU14LeMGBvBYQ03JJQ6Qjk1y+OnHtl0ePH3W63+p2evt6l8nj+f8B6abRC75wAHoAAAAASUVORK5CYII=\""],"sourceRoot":""}